{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.array.join.js","webpack:///./node_modules/core-js/modules/es.json.stringify.js","webpack:///./src/components/geoserver/wfs/QueryWFS.vue","webpack:///src/components/geoserver/wfs/QueryWFS.vue","webpack:///./src/components/geoserver/wfs/QueryWFS.vue?1663","webpack:///./src/components/geoserver/wfs/QueryWFS.vue?2618"],"names":["$","uncurryThis","IndexedObject","toIndexedObject","arrayMethodIsStrict","nativeJoin","join","ES3_STRINGS","Object","STRICT_METHOD","target","proto","forced","separator","this","undefined","getBuiltIn","apply","call","fails","isArray","isCallable","isObject","isSymbol","arraySlice","NATIVE_SYMBOL","$stringify","exec","charAt","charCodeAt","replace","numberToString","toString","tester","low","hi","WRONG_SYMBOLS_CONVERSION","symbol","a","ILL_FORMED_UNICODE","stringifyWithSymbolsFix","it","replacer","args","arguments","$replacer","key","value","fixIllFormed","match","offset","string","prev","next","stat","arity","stringify","space","result","render","_vm","_c","_self","attrs","path","_v","staticRenderFns","data","geoserverData","wsName","uri","wfsURL","layer","wfsFilter","created","mounted","methods","initMap","format","url","that","extent","strategy","title","source","style","image","radius","fill","color","opacity","getTdtLayer","layers","view","projection","center","zoom","findData","srcName","featureNS","featurePrefix","featureTypes","outputFormat","filter","fetch","method","body","console","geometryName","component"],"mappings":"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","file":"js/chunk-0829043e.fcf5df64.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar nativeJoin = uncurryThis([].join);\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar STRICT_METHOD = arrayMethodIsStrict('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.es/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {\n  join: function join(separator) {\n    return nativeJoin(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","var $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar apply = require('../internals/function-apply');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar isArray = require('../internals/is-array');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar isSymbol = require('../internals/is-symbol');\nvar arraySlice = require('../internals/array-slice');\nvar NATIVE_SYMBOL = require('../internals/symbol-constructor-detection');\n\nvar $stringify = getBuiltIn('JSON', 'stringify');\nvar exec = uncurryThis(/./.exec);\nvar charAt = uncurryThis(''.charAt);\nvar charCodeAt = uncurryThis(''.charCodeAt);\nvar replace = uncurryThis(''.replace);\nvar numberToString = uncurryThis(1.0.toString);\n\nvar tester = /[\\uD800-\\uDFFF]/g;\nvar low = /^[\\uD800-\\uDBFF]$/;\nvar hi = /^[\\uDC00-\\uDFFF]$/;\n\nvar WRONG_SYMBOLS_CONVERSION = !NATIVE_SYMBOL || fails(function () {\n  var symbol = getBuiltIn('Symbol')();\n  // MS Edge converts symbol values to JSON as {}\n  return $stringify([symbol]) != '[null]'\n    // WebKit converts symbol values to JSON as null\n    || $stringify({ a: symbol }) != '{}'\n    // V8 throws on boxed symbols\n    || $stringify(Object(symbol)) != '{}';\n});\n\n// https://github.com/tc39/proposal-well-formed-stringify\nvar ILL_FORMED_UNICODE = fails(function () {\n  return $stringify('\\uDF06\\uD834') !== '\"\\\\udf06\\\\ud834\"'\n    || $stringify('\\uDEAD') !== '\"\\\\udead\"';\n});\n\nvar stringifyWithSymbolsFix = function (it, replacer) {\n  var args = arraySlice(arguments);\n  var $replacer = replacer;\n  if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n  if (!isArray(replacer)) replacer = function (key, value) {\n    if (isCallable($replacer)) value = call($replacer, this, key, value);\n    if (!isSymbol(value)) return value;\n  };\n  args[1] = replacer;\n  return apply($stringify, null, args);\n};\n\nvar fixIllFormed = function (match, offset, string) {\n  var prev = charAt(string, offset - 1);\n  var next = charAt(string, offset + 1);\n  if ((exec(low, match) && !exec(hi, next)) || (exec(hi, match) && !exec(low, prev))) {\n    return '\\\\u' + numberToString(charCodeAt(match, 0), 16);\n  } return match;\n};\n\nif ($stringify) {\n  // `JSON.stringify` method\n  // https://tc39.es/ecma262/#sec-json.stringify\n  $({ target: 'JSON', stat: true, arity: 3, forced: WRONG_SYMBOLS_CONVERSION || ILL_FORMED_UNICODE }, {\n    // eslint-disable-next-line no-unused-vars -- required for `.length`\n    stringify: function stringify(it, replacer, space) {\n      var args = arraySlice(arguments);\n      var result = apply(WRONG_SYMBOLS_CONVERSION ? stringifyWithSymbolsFix : $stringify, null, args);\n      return ILL_FORMED_UNICODE && typeof result == 'string' ? replace(result, tester, fixIllFormed) : result;\n    }\n  });\n}\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('el-breadcrumb',{attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: '/home' }}},[_vm._v(\"首页\")]),_c('el-breadcrumb-item',[_vm._v(\"GeoServer\")]),_c('el-breadcrumb-item',[_vm._v(\"WFS\")]),_c('el-breadcrumb-item',[_vm._v(\"WFS查询数据\")])],1),_c('el-card',[_c('div',{attrs:{\"id\":\"map\"}})])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div>\r\n        <!--面包屑导航区域-->\r\n        <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n            <el-breadcrumb-item :to=\"{ path: '/home' }\">首页</el-breadcrumb-item>\r\n            <el-breadcrumb-item>GeoServer</el-breadcrumb-item>\r\n            <el-breadcrumb-item>WFS</el-breadcrumb-item>\r\n            <el-breadcrumb-item>WFS查询数据</el-breadcrumb-item>\r\n        </el-breadcrumb>\r\n        <!--卡片区域-->\r\n        <el-card>\r\n            <div id=\"map\"></div>\r\n        </el-card>\r\n    </div>\r\n</template>\r\n<script>\r\nimport Map from 'ol/map';\r\nimport View from 'ol/view';\r\nimport VectorLayer from 'ol/layer/vector';\r\nimport Vector from 'ol/source/vector';\r\nimport GeoJSON from 'ol/format/geojson';\r\nimport WFS from 'ol/format/wfs';\r\nimport filter from 'ol/format/filter';\r\nimport Style from 'ol/style/style';\r\nimport Circle from 'ol/style/circle';\r\nimport Fill from 'ol/style/fill';\r\nimport loadingstrategy from 'ol/loadingstrategy';\r\nimport {getTdtLayer} from \"../../../utils/searchUtils\";\r\nexport default {\r\n    data() {\r\n        return {\r\n            // 服务配置，命名空间、图层、服务地址等\r\n            geoserverData: {\r\n                wsName: 'webgistest',\r\n                uri: 'http://www.openplans.org/webgistest',\r\n                wfsURL: process.env.VUE_APP_GEOSERVER + 'geoserver/wfs?',\r\n                layer: 'port'\r\n            },\r\n            wfsFilter: null\r\n        }\r\n    },\r\n    created() {\r\n    },\r\n    mounted() {\r\n        this.initMap()\r\n    },\r\n    methods: {\r\n        initMap() {\r\n            const that = this\r\n            //测试数据 添加WFS数据  添加所有\r\n            let wfsSource = new Vector({\r\n                format: new GeoJSON(),\r\n                url: function (extent) {\r\n                    return (\r\n                        that.geoserverData.wfsURL + 'service=WFS&version=1.1.0&request=GetFeature&typeName=' +\r\n                        that.geoserverData.wsName + \":\" +\r\n                        that.geoserverData.layer + '&' + 'outputFormat=application/json&srsname=EPSG:4326&bbox=' +\r\n                        extent.join(',') + ',EPSG:4326');\r\n                },\r\n                strategy: loadingstrategy.bbox\r\n            });\r\n\r\n            let wfsLayer = new VectorLayer({\r\n                title: 'add WFS',\r\n                source: wfsSource,\r\n                style: new Style({\r\n                    image: new Circle({\r\n                        radius: 5,\r\n                        fill: new Fill({\r\n                            color: \"#389BCD\",\r\n                            opacity: 0.5,\r\n                        }),\r\n                    }),\r\n                })\r\n            })\r\n\r\n            let wfsFilter = new VectorLayer({\r\n                source: new Vector(),\r\n                style: new Style({\r\n                    image: new Circle({\r\n                        radius: 5,\r\n                        fill: new Fill({\r\n                            color: \"#d90000\",\r\n                            opacity: 0.5,\r\n                        }),\r\n                    }),\r\n                })\r\n            });\r\n\r\n            let layers = [\r\n              getTdtLayer(\"vec_w\"),\r\n              getTdtLayer(\"cva_w\"), wfsLayer, wfsFilter\r\n            ];\r\n\r\n            let map = new Map({\r\n                target: 'map',\r\n                layers: layers,\r\n                view: new View({\r\n                    projection: \"EPSG:4326\",\r\n                    center: [114, 31],\r\n                    zoom: 4\r\n                })\r\n            });\r\n            this.wfsFilter = wfsFilter\r\n            this.findData()\r\n        },\r\n        // 查询过滤图层\r\n        findData() {\r\n            const that = this\r\n            let data = {\r\n                srcName: 'EPSG:4326',\r\n                featureNS: this.geoserverData.uri,\r\n                featurePrefix: this.geoserverData.wsName,\r\n                featureTypes: [this.geoserverData.layer],\r\n                outputFormat: 'application/json',\r\n                // 查询方式就和写 SQL 一样\r\n                filter: filter.and(\r\n                    filter.like('porttype', '沿海'),\r\n                    filter.equalTo('name', '珠海港')\r\n                )\r\n            }\r\n            let request = new WFS().writeGetFeature(data)\r\n            fetch(that.geoserverData.wfsURL, {\r\n                method: 'POST',\r\n                body: new XMLSerializer().serializeToString(request),\r\n            }).then(function (response) {\r\n                return response.json()\r\n            }).then(function (json) {\r\n                console.log(JSON.stringify(json, null, \"\\t\"))\r\n                let features = new GeoJSON({\r\n                    geometryName: 'geom',\r\n                }).readFeatures(json)\r\n                if (that.wfsFilter) {\r\n                    that.wfsFilter.getSource().addFeatures(features)\r\n                }\r\n            })\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QueryWFS.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QueryWFS.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./QueryWFS.vue?vue&type=template&id=5ed246f6&scoped=true&\"\nimport script from \"./QueryWFS.vue?vue&type=script&lang=js&\"\nexport * from \"./QueryWFS.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5ed246f6\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}