(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-548ddc74"],{a15b:function(e,t,r){"use strict";var a=r("23e7"),n=r("e330"),o=r("44ad"),i=r("fc6a"),s=r("a640"),c=n([].join),u=o!==Object,l=u||!s("join",",");a({target:"Array",proto:!0,forced:l},{join:function(e){return c(i(this),void 0===e?",":e)}})},ee3e:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("GeoServer")]),t("el-breadcrumb-item",[e._v("WFS")]),t("el-breadcrumb-item",[e._v("WFS更新数据")])],1),t("el-card",[t("div",{attrs:{id:"map"}})])],1)},n=[],o=r("c7eb"),i=r("1da1"),s=(r("a15b"),r("43df")),c=r("332e"),u=r("e671"),l=r("02df"),d=r("169c"),p=r("14c4"),f=r("7269"),w=r("8d5e"),m=r("3e31"),g=r("29ae"),v=r("3110"),b=r("715e"),h=r("92cf"),y={data:function(){return{geoserverData:{wsName:"webgistest",uri:"http://www.openplans.org/webgistest",wfsURL:"http://localhost:28081/geoserver/wfs?",layer:"port"}}},created:function(){},mounted:function(){this.initMap()},methods:{initMap:function(){var e=this,t=new l["a"]({format:new d["a"],url:function(t){return e.geoserverData.wfsURL+"service=WFS&version=1.1.0&request=GetFeature&typeName="+e.geoserverData.wsName+":"+e.geoserverData.layer+"&outputFormat=application/json&srsname=EPSG:3857&bbox="+t.join(",")+",EPSG:3857"},strategy:b["a"].bbox}),r=new u["a"]({title:"add Layer",source:t,style:function(e){return new m["a"]({geometry:e.getGeometry(),image:new g["a"]({radius:5,fill:new v["a"]({color:"blue"})})})}}),a=[Object(h["d"])("vec_w"),Object(h["d"])("cva_w"),r],n=new s["a"]({target:"map",layers:a,view:new c["a"]({projection:"EPSG:3857",center:[12690421.9504332,3632749.14338443],zoom:4})}),o=new f["a"]({layers:[r],style:new m["a"]({image:new g["a"]({radius:8,fill:new v["a"]({color:"#f00"})})})}),i=new w["a"]({features:o.getFeatures()});n.addInteraction(o),n.addInteraction(i),i.setActive(!1),o.on("select",(function(e){var t=e.selected;t.length>0&&(t[0],r.getSource().changed())})),i.on("modifyend",(function(t){var r=t.features,a=r.item(0);e.updateFeature(a)})),n.on("click",(function(e){n.hasFeatureAtPixel(e.pixel)?i.setActive(!0):i.setActive(!1)})),n.on("pointermove",(function(e){n.hasFeatureAtPixel(e.pixel)?n.getTargetElement().style.cursor="pointer":n.getTargetElement().style.cursor="default"}))},updateFeature:function(e){var t=this;return Object(i["a"])(Object(o["a"])().mark((function r(){var a,n,i,s,c,u,l,d,f,w;return Object(o["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.clone(),n=e.getId(),a.setId(n),i=a.getProperties(),i.address="测试要素修改",s=a.getGeometry().getCoordinates(),i.lng=s[0],i.lat=s[1],a.setProperties(i),a.getGeometry().applyTransform((function(e,t,r){for(var a=0;a<e.length;a+=r){var n=e[a],o=e[a+1];e[a]=o,e[a+1]=n}})),a.setGeometryName("geom"),c=new p["a"],u=c.writeTransaction(null,[a],null,{featureType:t.geoserverData.layer,featureNS:t.geoserverData.uri,srsName:"EPSG:3857"}),l=new XMLSerializer,d=l.serializeToString(u),r.next=17,t.$http.post(t.geoserverData.wfsURL,d,{headers:{"Content-Type":"application/xml"}});case 17:f=r.sent,w=f.data,-1!=w.indexOf("Exception")?(console.log(w),alert("添加失败！"+w)):(alert("添加成功！"),window.location.reload());case 20:case"end":return r.stop()}}),r)})))()}}},j=y,x=r("2877"),S=Object(x["a"])(j,a,n,!1,null,"e318ed12",null);t["default"]=S.exports}}]);
//# sourceMappingURL=chunk-548ddc74.d96ca942.js.map