(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45972eef"],{"0a58":function(t,e,r){},2350:function(t,e,r){"use strict";var a={CARMENTA_SERVER:"carmentaserver",GEOSERVER:"geoserver",MAPSERVER:"mapserver",QGIS:"qgis"};e["a"]=a},3388:function(t,e,r){"use strict";var a=r("9d79"),i=r("0af5"),s=r("6a24"),o=r("e526"),n=r("b208"),l=r("abb7"),u=function(t,e,r){n["a"].call(this);var a=e||0;this.setCenterAndRadius(t,a,r)};a["a"].inherits(u,n["a"]),u.prototype.clone=function(){var t=new u(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},u.prototype.closestPointXY=function(t,e,r,a){var i=this.flatCoordinates,s=t-i[0],o=e-i[1],n=s*s+o*o;if(n<a){var l;if(0===n)for(l=0;l<this.stride;++l)r[l]=i[l];else{var u=this.getRadius()/Math.sqrt(n);for(r[0]=i[0]+u*s,r[1]=i[1]+u*o,l=2;l<this.stride;++l)r[l]=i[l]}return r.length=this.stride,n}return a},u.prototype.containsXY=function(t,e){var r=this.flatCoordinates,a=t-r[0],i=e-r[1];return a*a+i*i<=this.getRadiusSquared_()},u.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},u.prototype.computeExtent=function(t){var e=this.flatCoordinates,r=e[this.stride]-e[0];return i["a"].createOrUpdate(e[0]-r,e[1]-r,e[0]+r,e[1]+r,t)},u.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},u.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},u.prototype.getType=function(){return o["a"].CIRCLE},u.prototype.intersectsExtent=function(t){var e=this.getExtent();if(i["a"].intersects(t,e)){var r=this.getCenter();return t[0]<=r[0]&&t[2]>=r[0]||(t[1]<=r[1]&&t[3]>=r[1]||i["a"].forEachCorner(t,this.intersectsCoordinate,this))}return!1},u.prototype.setCenter=function(t){var e,r=this.stride,a=this.flatCoordinates[r]-this.flatCoordinates[0],i=t.slice();for(i[r]=i[0]+a,e=1;e<r;++e)i[r+e]=t[e];this.setFlatCoordinates(this.layout,i)},u.prototype.setCenterAndRadius=function(t,e,r){if(t){this.setLayout(r,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var a,i,o=this.flatCoordinates,n=l["a"].coordinate(o,0,t,this.stride);for(o[n++]=o[0]+e,a=1,i=this.stride;a<i;++a)o[n++]=o[a];o.length=n,this.changed()}else this.setFlatCoordinates(s["a"].XY,null)},u.prototype.getCoordinates=function(){},u.prototype.setCoordinates=function(t,e){},u.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},u.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},u.prototype.transform,e["a"]=u},"9fce":function(t,e,r){"use strict";r("0a58")},bcb4:function(t,e,r){"use strict";var a=r("9d79"),i=r("92fa"),s=r("0af5"),o=r("38f3"),n=r("7fc9"),l=r("256f"),u=r("3c81"),c=r("345d"),h=r("40f5"),p=r("2350"),d=r("2c30"),f=r("b0c1"),m=r("c721"),g=function(t){var e=t||{},r=e.params||{},a=!("TRANSPARENT"in r)||r["TRANSPARENT"];h["a"].call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,logo:e.logo,opaque:!a,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition}),this.gutter_=void 0!==e.gutter?e.gutter:0,this.params_=r,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=void 0===e.hidpi||e.hidpi,this.tmpExtent_=s["a"].createEmpty(),this.updateV13_(),this.setKey(this.getKeyForParams_())};a["a"].inherits(g,h["a"]),g.prototype.getGetFeatureInfoUrl=function(t,e,r,i){var n=l["a"].get(r),h=this.getProjection(),p=this.getTileGrid();p||(p=this.getTileGridForProjection(n));var d=p.getTileCoordForCoordAndResolution(t,e);if(!(p.getResolutions().length<=d[0])){var f=p.getResolution(d[0]),m=p.getTileCoordExtent(d,this.tmpExtent_),g=c["a"].toSize(p.getTileSize(d[0]),this.tmpSize),v=this.gutter_;0!==v&&(g=c["a"].buffer(g,v,this.tmpSize),m=s["a"].buffer(m,f*v,m)),h&&h!==n&&(f=u["a"].calculateSourceResolution(h,n,t,f),m=l["a"].transformExtent(m,n,h),t=l["a"].transform(t,n,h));var S={SERVICE:"WMS",VERSION:a["a"].DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_["LAYERS"]};o["a"].assign(S,this.params_,i);var _=Math.floor((t[0]-m[0])/f),y=Math.floor((m[3]-t[1])/f);return S[this.v13_?"I":"X"]=_,S[this.v13_?"J":"Y"]=y,this.getRequestUrl_(d,g,m,1,h||n,S)}},g.prototype.getGutterInternal=function(){return this.gutter_},g.prototype.getParams=function(){return this.params_},g.prototype.getRequestUrl_=function(t,e,r,a,s,o){var l=this.urls;if(l){if(o["WIDTH"]=e[0],o["HEIGHT"]=e[1],o[this.v13_?"CRS":"SRS"]=s.getCode(),"STYLES"in this.params_||(o["STYLES"]=""),1!=a)switch(this.serverType_){case p["a"].GEOSERVER:var u=90*a+.5|0;"FORMAT_OPTIONS"in o?o["FORMAT_OPTIONS"]+=";dpi:"+u:o["FORMAT_OPTIONS"]="dpi:"+u;break;case p["a"].MAPSERVER:o["MAP_RESOLUTION"]=90*a;break;case p["a"].CARMENTA_SERVER:case p["a"].QGIS:o["DPI"]=90*a;break;default:i["a"].assert(!1,52);break}var c,h,f=s.getAxisOrientation(),g=r;if(this.v13_&&"ne"==f.substr(0,2))c=r[0],g[0]=r[1],g[1]=c,c=r[2],g[2]=r[3],g[3]=c;if(o["BBOX"]=g.join(","),1==l.length)h=l[0];else{var v=n["a"].modulo(d["a"].hash(t),l.length);h=l[v]}return m["a"].appendParams(h,o)}},g.prototype.getTilePixelRatio=function(t){return this.hidpi_&&void 0!==this.serverType_?t:1},g.prototype.getKeyForParams_=function(){var t=0,e=[];for(var r in this.params_)e[t++]=r+"-"+this.params_[r];return e.join("/")},g.prototype.fixedTileUrlFunction=function(t,e,r){var i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),!(i.getResolutions().length<=t[0])){1==e||this.hidpi_&&void 0!==this.serverType_||(e=1);var n=i.getResolution(t[0]),l=i.getTileCoordExtent(t,this.tmpExtent_),u=c["a"].toSize(i.getTileSize(t[0]),this.tmpSize),h=this.gutter_;0!==h&&(u=c["a"].buffer(u,h,this.tmpSize),l=s["a"].buffer(l,n*h,l)),1!=e&&(u=c["a"].scale(u,e,this.tmpSize));var p={SERVICE:"WMS",VERSION:a["a"].DEFAULT_WMS_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return o["a"].assign(p,this.params_),this.getRequestUrl_(t,u,l,e,r,p)}},g.prototype.updateParams=function(t){o["a"].assign(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())},g.prototype.updateV13_=function(){var t=this.params_["VERSION"]||a["a"].DEFAULT_WMS_VERSION;this.v13_=f["a"].compareVersions(t,"1.3")>=0},e["a"]=g},c721:function(t,e,r){"use strict";var a={appendParams:function(t,e){var r=[];Object.keys(e).forEach((function(t){null!==e[t]&&void 0!==e[t]&&r.push(t+"="+encodeURIComponent(e[t]))}));var a=r.join("&");return t=t.replace(/[?&]$/,""),t=-1===t.indexOf("?")?t+"?":t+"&",t+a}};e["a"]=a},ca65:function(t,e,r){"use strict";r.r(e);r("b0c0");var a=function(){var t=this,e=t._self._c;return e("div",[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[t._v("首页")]),e("el-breadcrumb-item",[t._v("GeoServer")]),e("el-breadcrumb-item",[t._v("WFS")]),e("el-breadcrumb-item",[t._v("WFS综合查询")])],1),e("el-card",[e("div",{staticClass:"div_auto"},[e("el-autocomplete",{staticStyle:{width:"250px"},attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:"请输入搜索内容","value-key":"name"},on:{select:t.handleSelect,change:t.handleInput},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}})],1),e("div",{staticClass:"div_button",staticStyle:{left:"580px"}},[e("el-select",{attrs:{placeholder:"请选择查询的图层"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.selectLayer,(function(t){return e("el-option",{key:t.value,attrs:{label:t.name,value:t.name}})})),1)],1),e("div",{staticClass:"div_button",staticStyle:{right:"50px"}},[e("el-form",{ref:"form",attrs:{model:t.nearForm,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"输入圆心"}},[e("el-input",{attrs:{placeholder:"请输入经纬度"},model:{value:t.nearForm.lnglat,callback:function(e){t.$set(t.nearForm,"lnglat",e)},expression:"nearForm.lnglat"}})],1),e("el-form-item",{attrs:{label:"输入半径"}},[e("el-input",{model:{value:t.nearForm.radius,callback:function(e){t.$set(t.nearForm,"radius",e)},expression:"nearForm.radius"}})],1),e("el-form-item",{attrs:{label:"地图显示"}},[e("el-switch",{model:{value:t.nearForm.show,callback:function(e){t.$set(t.nearForm,"show",e)},expression:"nearForm.show"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.searchNearBy}},[t._v("周边搜索")])],1)],1)],1),e("div",{attrs:{id:"map"}})])],1)},i=[],s=(r("d81d"),r("d3b7"),r("25f0"),r("a9e3"),r("92cf")),o=r("43df"),n=r("332e"),l=r("3388"),u=r("09d8"),c=r("4ca6"),h=r("bcb4"),p=r("170b"),d=r("21bc"),f={data:function(){return{url:"http://localhost:28081/",map:null,input:"",restaurants:[],type:"查询所有信息",selectLayer:[{name:"查询地名信息(poi)",value:"poi"},{name:"查询地标信息(landmarks)",value:"landmarks"},{name:"查询道路信息(roads)",value:"roads"},{name:"查询所有信息",value:""}],nearForm:{lnglat:"-73.98,40.76",radius:500,show:!0}}},created:function(){},mounted:function(){this.initMap()},methods:{initMap:function(){var t=this,e=new n["a"]({zoom:13,projection:"EPSG:4326",center:[-73.98,40.79]}),r=new c["a"]({source:new h["a"]({url:this.url+"geoserver/wms",params:{FORMAT:"image/png",tiled:!0,LAYERS:["tiger:poly_landmarks","tiger:tiger_roads","tiger:poi"],tilesOrigin:"-74.047185,40.679648"}})});this.map=new o["a"]({controls:d["a"].defaults({attribution:!1}).extend([]),target:"map",layers:[Object(s["d"])("vec_w"),Object(s["d"])("cva_w"),r],view:e}),this.map.on("singleclick",(function(e){t.nearForm.lnglat=e.coordinate.toString()}))},querySearchAsync:function(t,e){console.log(t);var r=this;Object(s["b"])(this.url,this.type,t,5).then((function(t){console.log("关键字搜索结果",t),r.restaurants=[],r.restaurants=Object(s["c"])(t),e(r.restaurants)}))},handleSelect:function(t){Object(s["a"])(this.map,t.id)},handleInput:function(t){this.querySearchAsync(t)},searchNearBy:function(){var t=this,e=new p["a"]({code:"EPSG:4326",units:"degrees",global:!0}),r=e.getMetersPerUnit(),a=new l["a"](this.nearForm.lnglat.split(",").map(Number),this.nearForm.radius/r),i=new u["a"].fromCircle(a);console.log(i),Object(s["e"])(this.map,this.url,this.type,10,i).then((function(e){console.log("空间查询结果",e),t.nearForm.show&&Object(s["a"])(t.map,"")}))}}},m=f,g=(r("9fce"),r("2877")),v=Object(g["a"])(m,a,i,!1,null,null,null);e["default"]=v.exports}}]);
//# sourceMappingURL=chunk-45972eef.961c2c9a.js.map