{"version":3,"sources":["webpack:///./node_modules/ol/source/wmtsrequestencoding.js","webpack:///./node_modules/ol/source/wmts.js","webpack:///./node_modules/ol/layer/image.js","webpack:///./src/components/analysis/BuffAnalysis.vue","webpack:///src/components/analysis/BuffAnalysis.vue","webpack:///./src/components/analysis/BuffAnalysis.vue?b593","webpack:///./src/components/analysis/BuffAnalysis.vue?42c1","webpack:///./node_modules/ol/source/wmsservertype.js","webpack:///./node_modules/ol/image.js","webpack:///./node_modules/ol/reproj/image.js","webpack:///./node_modules/ol/source/image.js","webpack:///./node_modules/ol/source/imagewms.js","webpack:///./node_modules/ol/style/iconanchorunits.js","webpack:///./node_modules/ol/style/iconimage.js","webpack:///./node_modules/ol/style/iconorigin.js","webpack:///./node_modules/ol/style/icon.js","webpack:///./node_modules/ol/format/textfeature.js","webpack:///./node_modules/ol/format/wkt.js","webpack:///./node_modules/ol/style/text.js","webpack:///./node_modules/ol/source/osm.js","webpack:///./node_modules/ol/tilegrid/wmts.js","webpack:///./src/components/analysis/BuffAnalysis.vue?caf7","webpack:///./node_modules/ol/source/tilewms.js","webpack:///./node_modules/ol/uri.js"],"names":["_ol_source_WMTSRequestEncoding_","KVP","REST","_ol_source_WMTS_","options","this","version_","undefined","version","format_","format","dimensions_","dimensions","layer_","layer","matrixSet_","matrixSet","style_","style","urls","url","expandUrl","requestEncoding_","requestEncoding","tileGrid","context","assign","createFromWMTSTemplate_","template","appendParams","replace","m","p","toLowerCase","tileCoord","pixelRatio","projection","localContext","getMatrixId","tileUrlFunction","length","createFromTileUrlFunctions","map","nullTileUrlFunction","call","attributions","cacheSize","crossOrigin","logo","reprojectionErrorThreshold","tileClass","tileLoadFunction","tilePixelRatio","wrapX","transition","setKey","getKeyForDimensions_","inherits","prototype","setUrls","key","join","setTileUrlFunction","fixedTileUrlFunction","bind","getDimensions","getFormat","getLayer","getMatrixSet","getRequestEncoding","getStyle","getVersion","i","res","updateDimensions","optionsFromCapabilities","wmtsCap","config","layers","l","find","elt","index","array","idx","matrixLimits","tileMatrixSets","findIndex","tileMatrixSet","el","supportedCRS","proj1","get","proj2","equivalent","forEach","value","matrixSets","matrixSetObj","code","projConfig","extent","wgs84BoundingBox","wgs84ProjectionExtent","getExtent","transformExtent","projectionExtent","containsExtent","createFromCapabilitiesMatrixSet","gets","ii","constraint","element","encodings","includes","push","_ol_layer_Image_","opt_options","type","IMAGE","getSource","render","_vm","_c","_self","attrs","path","_v","model","geom1","callback","$$v","expression","geom","distance","on","analysis","staticRenderFns","data","source","created","mounted","initMap","methods","view","View","zoom","center","proj","fromLonLat","Vector","features","vector","VectorLayer","styleFunction","Map","controls","control","defaults","attribution","extend","target","getTdtLayer","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$_this$$API$buf","wkts","wktformat","feature","wrap","_context","prev","next","clear","$API","buffAnalysis","sent","success","msg","WKT","readFeature","getGeometry","transform","set","addFeatures","stop","component","_ol_source_WMSServerType_","CARMENTA_SERVER","GEOSERVER","MAPSERVER","QGIS","_ol_Image_","resolution","src","imageLoadFunction","IDLE","src_","image_","Image","imageListenerKeys_","state","imageLoadFunction_","getImage","handleImageError_","ERROR","unlistenImage_","changed","handleImageLoad_","getHeight","height","LOADED","load","LOADING","listenOnce","LOAD","setImage","image","unlistenByKey","_ol_reproj_Image_","sourceProj","targetProj","targetExtent","targetResolution","getImageFunction","targetProj_","maxSourceExtent_","maxTargetExtent","limitedTargetExtent","getIntersection","targetCenter","getCenter","sourceResolution","calculateSourceResolution","errorThresholdInPixels","DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD","triangulation_","targetResolution_","targetExtent_","sourceExtent","calculateSourceExtent","sourceImage_","sourcePixelRatio_","getPixelRatio","canvas_","sourceListenerKey_","disposeInternal","unlistenSource_","getProjection","reproject_","sourceState","getState","width","getWidth","getResolution","listen","CHANGE","e","_ol_source_Image_","resolutions_","resolutions","reprojectedImage_","reprojectedRevision_","getResolutions","findNearestResolution","linearFindNearest","sourceProjection","ENABLE_RASTER_REPROJECTION","getRevision","equals","dispose","getImageInternal","handleImageChange","event","dispatchEvent","Event","EventType_","IMAGELOADSTART","IMAGELOADEND","IMAGELOADERROR","defaultImageLoadFunction","_ol_source_ImageWMS_","crossOrigin_","url_","params_","params","v13_","updateV13_","serverType_","hidpi_","hidpi","imageSize_","renderedRevision_","ratio_","ratio","GETFEATUREINFO_IMAGE_SIZE_","getGetFeatureInfoUrl","coordinate","projectionObj","sourceProjectionObj","getForViewAndSize","baseParams","DEFAULT_WMS_VERSION","x","Math","floor","y","getRequestUrl_","getParams","imageResolution","viewWidth","ceil","viewHeight","viewExtent","requestWidth","requestHeight","requestExtent","round","getImageLoadFunction","size","assert","getCode","dpi","bbox","axisOrientation","getAxisOrientation","substr","getUrl","setImageLoadFunction","setUrl","updateParams","compareVersions","_ol_style_IconAnchorUnits_","FRACTION","PIXELS","_ol_style_IconImage_","imageState","color","hitDetectionImage_","document","createElement","color_","imageState_","size_","tainting_","determineTainting_","iconImageCache","iconImage","createCanvasContext2D","drawImage","getImageData","dispatchChangeEvent_","replaceColor_","getImageState","getHitDetectionImage","fillRect","canvas","getSize","getSrc","ctx","getContext","imgData","r","g","b","putImageData","_ol_style_IconOrigin_","BOTTOM_LEFT","BOTTOM_RIGHT","TOP_LEFT","TOP_RIGHT","_ol_style_Icon_","anchor_","anchor","normalizedAnchor_","anchorOrigin_","anchorOrigin","anchorXUnits_","anchorXUnits","anchorYUnits_","anchorYUnits","img","imgSize","getUid","toString","asArray","iconImage_","offset_","offset","offsetOrigin_","offsetOrigin","origin_","opacity","rotateWithView","rotation","scale","snapToPixel","clone","slice","getOpacity","getScale","getSnapToPixel","getRotation","getRotateWithView","getAnchor","getColor","getImageSize","getHitDetectionImageSize","getOrigin","iconImageSize","listenImageChange","listener","thisArg","unlistenImageChange","unlisten","_ol_format_TextFeature_","getText_","getType","TEXT","readFeatureFromText","adaptOptions","text","readFeatures","readFeaturesFromText","readGeometry","readGeometryFromText","readProjection","readProjectionFromText","defaultDataProjection","writeFeature","writeFeatureText","writeFeatures","writeFeaturesText","writeGeometry","geometry","writeGeometryText","_ol_format_WKT_","splitCollection_","splitCollection","EMPTY","Z","M","ZM","encodePointGeometry_","coordinates","getCoordinates","encodeMultiPointGeometry_","components","getPoints","encodeGeometryCollectionGeometry_","geoms","getGeometries","encode_","encodeLineStringGeometry_","encodeMultiLineStringGeometry_","getLineStrings","encodePolygonGeometry_","rings","getLinearRings","encodeMultiPolygonGeometry_","getPolygons","encodeGeometryLayout_","layout","getLayout","dimInfo","XYZ","XYZM","XYM","geometryEncoder","GeometryEncoder_","enc","toUpperCase","parse_","wkt","lexer","Lexer","parser","Parser","parse","setGeometry","geometries","GEOMETRY_COLLECTION","getGeometriesArray","transformWithOptions","collection","TokenType_","LEFT_PAREN","RIGHT_PAREN","NUMBER","COMMA","EOF","index_","isAlpha_","c","isNumeric_","opt_decimal","decimal","isWhiteSpace_","nextChar_","charAt","nextToken","token","position","readNumber_","readText_","Error","scientificNotation","parseFloat","substring","lexer_","token_","layout_","XY","consume_","isTokenType","isMatch","match","parseGeometry_","parseGeometryLayout_","dimToken","geomType","parseGeometryCollectionText_","GeometryParser_","ctor","GeometryConstructor_","formatErrorMessage_","isEmptyGeometry_","parsePointText_","parsePoint_","parseLineStringText_","parsePointList_","parsePolygonText_","parseLineStringTextList_","parseMultiPointText_","parsePointTextList_","parseMultiLineStringText_","parseMultiPolygonText_","parsePolygonTextList_","isEmpty","_ol_style_Text_","font_","font","rotation_","rotateWithView_","scale_","text_","textAlign_","textAlign","textBaseline_","textBaseline","fill_","fill","DEFAULT_FILL_COLOR_","maxAngle_","maxAngle","PI","placement_","placement","POINT","overflow","exceedLength","overflow_","stroke_","stroke","offsetX_","offsetX","offsetY_","offsetY","backgroundFill_","backgroundFill","backgroundStroke_","backgroundStroke","padding_","padding","getFont","getPlacement","getMaxAngle","getOverflow","getText","getTextAlign","getTextBaseline","getFill","getStroke","getOffsetX","getOffsetY","getBackgroundFill","getBackgroundStroke","getPadding","setOverflow","setFont","setMaxAngle","setOffsetX","setOffsetY","setPlacement","setFill","setRotation","setScale","setStroke","setText","setTextAlign","setTextBaseline","setBackgroundFill","setBackgroundStroke","setPadding","_ol_source_OSM_","ATTRIBUTION","opaque","maxZoom","_ol_tilegrid_WMTS_","matrixIds_","matrixIds","origin","origins","tileSize","tileSizes","sizes","z","getMatrixIds","opt_extent","opt_matrixLimits","supportedCRSPropName","matrixIdsPropName","identifierPropName","scaleDenominatorPropName","topLeftCornerPropName","tileWidthPropName","tileHeightPropName","metersPerUnit","getMetersPerUnit","switchOriginXY","sort","a","matrixAvailable","elt_ml","index_ml","array_ml","tileWidth","tileHeight","_ol_source_TileWMS_","transparent","gutter_","gutter","tmpExtent_","createEmpty","getKeyForParams_","getTileGrid","getTileGridForProjection","getTileCoordForCoordAndResolution","tileResolution","tileExtent","getTileCoordExtent","toSize","getTileSize","tmpSize","buffer","getGutterInternal","tmp","modulo","hash","getTilePixelRatio","_ol_uri_","uri","keyParams","Object","keys","k","encodeURIComponent","qs","indexOf"],"mappings":"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","file":"js/chunk-6ff2d83d.bc15c3e5.js","sourcesContent":["/**\n * Request encoding. One of 'KVP', 'REST'.\n * @enum {string}\n */\nvar _ol_source_WMTSRequestEncoding_ = {\n  KVP: 'KVP',  // see spec 8\n  REST: 'REST' // see spec 10\n};\n\nexport default _ol_source_WMTSRequestEncoding_;\n","import _ol_ from '../index.js';\nimport _ol_TileUrlFunction_ from '../tileurlfunction.js';\nimport _ol_array_ from '../array.js';\nimport _ol_extent_ from '../extent.js';\nimport _ol_obj_ from '../obj.js';\nimport _ol_proj_ from '../proj.js';\nimport _ol_source_TileImage_ from '../source/tileimage.js';\nimport _ol_source_WMTSRequestEncoding_ from '../source/wmtsrequestencoding.js';\nimport _ol_tilegrid_WMTS_ from '../tilegrid/wmts.js';\nimport _ol_uri_ from '../uri.js';\n\n/**\n * @classdesc\n * Layer source for tile data from WMTS servers.\n *\n * @constructor\n * @extends {ol.source.TileImage}\n * @param {olx.source.WMTSOptions} options WMTS options.\n * @api\n */\nvar _ol_source_WMTS_ = function(options) {\n\n  // TODO: add support for TileMatrixLimits\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.version_ = options.version !== undefined ? options.version : '1.0.0';\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.format_ = options.format !== undefined ? options.format : 'image/jpeg';\n\n  /**\n   * @private\n   * @type {!Object}\n   */\n  this.dimensions_ = options.dimensions !== undefined ? options.dimensions : {};\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.layer_ = options.layer;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.matrixSet_ = options.matrixSet;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.style_ = options.style;\n\n  var urls = options.urls;\n  if (urls === undefined && options.url !== undefined) {\n    urls = _ol_TileUrlFunction_.expandUrl(options.url);\n  }\n\n  // FIXME: should we guess this requestEncoding from options.url(s)\n  //        structure? that would mean KVP only if a template is not provided.\n\n  /**\n   * @private\n   * @type {ol.source.WMTSRequestEncoding}\n   */\n  this.requestEncoding_ = options.requestEncoding !== undefined ?\n    /** @type {ol.source.WMTSRequestEncoding} */ (options.requestEncoding) :\n    _ol_source_WMTSRequestEncoding_.KVP;\n\n  var requestEncoding = this.requestEncoding_;\n\n  // FIXME: should we create a default tileGrid?\n  // we could issue a getCapabilities xhr to retrieve missing configuration\n  var tileGrid = options.tileGrid;\n\n  // context property names are lower case to allow for a case insensitive\n  // replacement as some services use different naming conventions\n  var context = {\n    'layer': this.layer_,\n    'style': this.style_,\n    'tilematrixset': this.matrixSet_\n  };\n\n  if (requestEncoding == _ol_source_WMTSRequestEncoding_.KVP) {\n    _ol_obj_.assign(context, {\n      'Service': 'WMTS',\n      'Request': 'GetTile',\n      'Version': this.version_,\n      'Format': this.format_\n    });\n  }\n\n  var dimensions = this.dimensions_;\n\n  /**\n   * @param {string} template Template.\n   * @return {ol.TileUrlFunctionType} Tile URL function.\n   * @private\n   */\n  this.createFromWMTSTemplate_ = function(template) {\n\n    // TODO: we may want to create our own appendParams function so that params\n    // order conforms to wmts spec guidance, and so that we can avoid to escape\n    // special template params\n\n    template = (requestEncoding == _ol_source_WMTSRequestEncoding_.KVP) ?\n      _ol_uri_.appendParams(template, context) :\n      template.replace(/\\{(\\w+?)\\}/g, function(m, p) {\n        return (p.toLowerCase() in context) ? context[p.toLowerCase()] : m;\n      });\n\n    return (\n      /**\n       * @param {ol.TileCoord} tileCoord Tile coordinate.\n       * @param {number} pixelRatio Pixel ratio.\n       * @param {ol.proj.Projection} projection Projection.\n       * @return {string|undefined} Tile URL.\n       */\n      function(tileCoord, pixelRatio, projection) {\n        if (!tileCoord) {\n          return undefined;\n        } else {\n          var localContext = {\n            'TileMatrix': tileGrid.getMatrixId(tileCoord[0]),\n            'TileCol': tileCoord[1],\n            'TileRow': -tileCoord[2] - 1\n          };\n          _ol_obj_.assign(localContext, dimensions);\n          var url = template;\n          if (requestEncoding == _ol_source_WMTSRequestEncoding_.KVP) {\n            url = _ol_uri_.appendParams(url, localContext);\n          } else {\n            url = url.replace(/\\{(\\w+?)\\}/g, function(m, p) {\n              return localContext[p];\n            });\n          }\n          return url;\n        }\n      }\n    );\n  };\n\n  var tileUrlFunction = (urls && urls.length > 0) ?\n    _ol_TileUrlFunction_.createFromTileUrlFunctions(\n        urls.map(this.createFromWMTSTemplate_)) :\n    _ol_TileUrlFunction_.nullTileUrlFunction;\n\n  _ol_source_TileImage_.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: options.crossOrigin,\n    logo: options.logo,\n    projection: options.projection,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileClass: options.tileClass,\n    tileGrid: tileGrid,\n    tileLoadFunction: options.tileLoadFunction,\n    tilePixelRatio: options.tilePixelRatio,\n    tileUrlFunction: tileUrlFunction,\n    urls: urls,\n    wrapX: options.wrapX !== undefined ? options.wrapX : false,\n    transition: options.transition\n  });\n\n  this.setKey(this.getKeyForDimensions_());\n\n};\n\n_ol_.inherits(_ol_source_WMTS_, _ol_source_TileImage_);\n\n/**\n * Set the URLs to use for requests.\n * URLs may contain OCG conform URL Template Variables: {TileMatrix}, {TileRow}, {TileCol}.\n * @override\n */\n_ol_source_WMTS_.prototype.setUrls = function(urls) {\n  this.urls = urls;\n  var key = urls.join('\\n');\n  this.setTileUrlFunction(this.fixedTileUrlFunction ?\n    this.fixedTileUrlFunction.bind(this) :\n    _ol_TileUrlFunction_.createFromTileUrlFunctions(urls.map(this.createFromWMTSTemplate_.bind(this))), key);\n};\n\n/**\n * Get the dimensions, i.e. those passed to the constructor through the\n * \"dimensions\" option, and possibly updated using the updateDimensions\n * method.\n * @return {!Object} Dimensions.\n * @api\n */\n_ol_source_WMTS_.prototype.getDimensions = function() {\n  return this.dimensions_;\n};\n\n\n/**\n * Return the image format of the WMTS source.\n * @return {string} Format.\n * @api\n */\n_ol_source_WMTS_.prototype.getFormat = function() {\n  return this.format_;\n};\n\n\n/**\n * Return the layer of the WMTS source.\n * @return {string} Layer.\n * @api\n */\n_ol_source_WMTS_.prototype.getLayer = function() {\n  return this.layer_;\n};\n\n\n/**\n * Return the matrix set of the WMTS source.\n * @return {string} MatrixSet.\n * @api\n */\n_ol_source_WMTS_.prototype.getMatrixSet = function() {\n  return this.matrixSet_;\n};\n\n\n/**\n * Return the request encoding, either \"KVP\" or \"REST\".\n * @return {ol.source.WMTSRequestEncoding} Request encoding.\n * @api\n */\n_ol_source_WMTS_.prototype.getRequestEncoding = function() {\n  return this.requestEncoding_;\n};\n\n\n/**\n * Return the style of the WMTS source.\n * @return {string} Style.\n * @api\n */\n_ol_source_WMTS_.prototype.getStyle = function() {\n  return this.style_;\n};\n\n\n/**\n * Return the version of the WMTS source.\n * @return {string} Version.\n * @api\n */\n_ol_source_WMTS_.prototype.getVersion = function() {\n  return this.version_;\n};\n\n\n/**\n * @private\n * @return {string} The key for the current dimensions.\n */\n_ol_source_WMTS_.prototype.getKeyForDimensions_ = function() {\n  var i = 0;\n  var res = [];\n  for (var key in this.dimensions_) {\n    res[i++] = key + '-' + this.dimensions_[key];\n  }\n  return res.join('/');\n};\n\n\n/**\n * Update the dimensions.\n * @param {Object} dimensions Dimensions.\n * @api\n */\n_ol_source_WMTS_.prototype.updateDimensions = function(dimensions) {\n  _ol_obj_.assign(this.dimensions_, dimensions);\n  this.setKey(this.getKeyForDimensions_());\n};\n\n\n/**\n * Generate source options from a capabilities object.\n * @param {Object} wmtsCap An object representing the capabilities document.\n * @param {Object} config Configuration properties for the layer.  Defaults for\n *                  the layer will apply if not provided.\n *\n * Required config properties:\n *  - layer - {string} The layer identifier.\n *\n * Optional config properties:\n *  - matrixSet - {string} The matrix set identifier, required if there is\n *       more than one matrix set in the layer capabilities.\n *  - projection - {string} The desired CRS when no matrixSet is specified.\n *       eg: \"EPSG:3857\". If the desired projection is not available,\n *       an error is thrown.\n *  - requestEncoding - {string} url encoding format for the layer. Default is\n *       the first tile url format found in the GetCapabilities response.\n *  - style - {string} The name of the style\n *  - format - {string} Image format for the layer. Default is the first\n *       format returned in the GetCapabilities response.\n *  - crossOrigin - {string|null|undefined} Cross origin. Default is `undefined`.\n * @return {?olx.source.WMTSOptions} WMTS source options object or `null` if the layer was not found.\n * @api\n */\n_ol_source_WMTS_.optionsFromCapabilities = function(wmtsCap, config) {\n  var layers = wmtsCap['Contents']['Layer'];\n  var l = _ol_array_.find(layers, function(elt, index, array) {\n    return elt['Identifier'] == config['layer'];\n  });\n  if (l === null) {\n    return null;\n  }\n  var tileMatrixSets = wmtsCap['Contents']['TileMatrixSet'];\n  var idx, matrixSet, matrixLimits;\n  if (l['TileMatrixSetLink'].length > 1) {\n    if ('projection' in config) {\n      idx = _ol_array_.findIndex(l['TileMatrixSetLink'],\n          function(elt, index, array) {\n            var tileMatrixSet = _ol_array_.find(tileMatrixSets, function(el) {\n              return el['Identifier'] == elt['TileMatrixSet'];\n            });\n            var supportedCRS = tileMatrixSet['SupportedCRS'];\n            var proj1 = _ol_proj_.get(supportedCRS.replace(/urn:ogc:def:crs:(\\w+):(.*:)?(\\w+)$/, '$1:$3')) ||\n                _ol_proj_.get(supportedCRS);\n            var proj2 = _ol_proj_.get(config['projection']);\n            if (proj1 && proj2) {\n              return _ol_proj_.equivalent(proj1, proj2);\n            } else {\n              return supportedCRS == config['projection'];\n            }\n          });\n    } else {\n      idx = _ol_array_.findIndex(l['TileMatrixSetLink'],\n          function(elt, index, array) {\n            return elt['TileMatrixSet'] == config['matrixSet'];\n          });\n    }\n  } else {\n    idx = 0;\n  }\n  if (idx < 0) {\n    idx = 0;\n  }\n  matrixSet = /** @type {string} */\n    (l['TileMatrixSetLink'][idx]['TileMatrixSet']);\n  matrixLimits = /** @type {Array.<Object>} */\n    (l['TileMatrixSetLink'][idx]['TileMatrixSetLimits']);\n\n  var format = /** @type {string} */ (l['Format'][0]);\n  if ('format' in config) {\n    format = config['format'];\n  }\n  idx = _ol_array_.findIndex(l['Style'], function(elt, index, array) {\n    if ('style' in config) {\n      return elt['Title'] == config['style'];\n    } else {\n      return elt['isDefault'];\n    }\n  });\n  if (idx < 0) {\n    idx = 0;\n  }\n  var style = /** @type {string} */ (l['Style'][idx]['Identifier']);\n\n  var dimensions = {};\n  if ('Dimension' in l) {\n    l['Dimension'].forEach(function(elt, index, array) {\n      var key = elt['Identifier'];\n      var value = elt['Default'];\n      if (value === undefined) {\n        value = elt['Value'][0];\n      }\n      dimensions[key] = value;\n    });\n  }\n\n  var matrixSets = wmtsCap['Contents']['TileMatrixSet'];\n  var matrixSetObj = _ol_array_.find(matrixSets, function(elt, index, array) {\n    return elt['Identifier'] == matrixSet;\n  });\n\n  var projection;\n  var code = matrixSetObj['SupportedCRS'];\n  if (code) {\n    projection = _ol_proj_.get(code.replace(/urn:ogc:def:crs:(\\w+):(.*:)?(\\w+)$/, '$1:$3')) ||\n        _ol_proj_.get(code);\n  }\n  if ('projection' in config) {\n    var projConfig = _ol_proj_.get(config['projection']);\n    if (projConfig) {\n      if (!projection || _ol_proj_.equivalent(projConfig, projection)) {\n        projection = projConfig;\n      }\n    }\n  }\n\n  var wgs84BoundingBox = l['WGS84BoundingBox'];\n  var extent, wrapX;\n  if (wgs84BoundingBox !== undefined) {\n    var wgs84ProjectionExtent = _ol_proj_.get('EPSG:4326').getExtent();\n    wrapX = (wgs84BoundingBox[0] == wgs84ProjectionExtent[0] &&\n        wgs84BoundingBox[2] == wgs84ProjectionExtent[2]);\n    extent = _ol_proj_.transformExtent(\n        wgs84BoundingBox, 'EPSG:4326', projection);\n    var projectionExtent = projection.getExtent();\n    if (projectionExtent) {\n      // If possible, do a sanity check on the extent - it should never be\n      // bigger than the validity extent of the projection of a matrix set.\n      if (!_ol_extent_.containsExtent(projectionExtent, extent)) {\n        extent = undefined;\n      }\n    }\n  }\n\n  var tileGrid = _ol_tilegrid_WMTS_.createFromCapabilitiesMatrixSet(\n      matrixSetObj, extent, matrixLimits);\n\n  /** @type {!Array.<string>} */\n  var urls = [];\n  var requestEncoding = config['requestEncoding'];\n  requestEncoding = requestEncoding !== undefined ? requestEncoding : '';\n\n  if ('OperationsMetadata' in wmtsCap && 'GetTile' in wmtsCap['OperationsMetadata']) {\n    var gets = wmtsCap['OperationsMetadata']['GetTile']['DCP']['HTTP']['Get'];\n\n    for (var i = 0, ii = gets.length; i < ii; ++i) {\n      if (gets[i]['Constraint']) {\n        var constraint = _ol_array_.find(gets[i]['Constraint'], function(element) {\n          return element['name'] == 'GetEncoding';\n        });\n        var encodings = constraint['AllowedValues']['Value'];\n\n        if (requestEncoding === '') {\n          // requestEncoding not provided, use the first encoding from the list\n          requestEncoding = encodings[0];\n        }\n        if (requestEncoding === _ol_source_WMTSRequestEncoding_.KVP) {\n          if (_ol_array_.includes(encodings, _ol_source_WMTSRequestEncoding_.KVP)) {\n            urls.push(/** @type {string} */ (gets[i]['href']));\n          }\n        } else {\n          break;\n        }\n      } else if (gets[i]['href']) {\n        requestEncoding = _ol_source_WMTSRequestEncoding_.KVP;\n        urls.push(/** @type {string} */ (gets[i]['href']));\n      }\n    }\n  }\n  if (urls.length === 0) {\n    requestEncoding = _ol_source_WMTSRequestEncoding_.REST;\n    l['ResourceURL'].forEach(function(element) {\n      if (element['resourceType'] === 'tile') {\n        format = element['format'];\n        urls.push(/** @type {string} */ (element['template']));\n      }\n    });\n  }\n\n  return {\n    urls: urls,\n    layer: config['layer'],\n    matrixSet: matrixSet,\n    format: format,\n    projection: projection,\n    requestEncoding: requestEncoding,\n    tileGrid: tileGrid,\n    style: style,\n    dimensions: dimensions,\n    wrapX: wrapX,\n    crossOrigin: config['crossOrigin']\n  };\n};\nexport default _ol_source_WMTS_;\n","import _ol_ from '../index.js';\nimport _ol_LayerType_ from '../layertype.js';\nimport _ol_layer_Layer_ from '../layer/layer.js';\n\n/**\n * @classdesc\n * Server-rendered images that are available for arbitrary extents and\n * resolutions.\n * Note that any property set in the options is set as a {@link ol.Object}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @constructor\n * @extends {ol.layer.Layer}\n * @fires ol.render.Event\n * @param {olx.layer.ImageOptions=} opt_options Layer options.\n * @api\n */\nvar _ol_layer_Image_ = function(opt_options) {\n  var options = opt_options ? opt_options : {};\n  _ol_layer_Layer_.call(this,  /** @type {olx.layer.LayerOptions} */ (options));\n\n  /**\n   * The layer type.\n   * @protected\n   * @type {ol.LayerType}\n   */\n  this.type = _ol_LayerType_.IMAGE;\n\n};\n\n_ol_.inherits(_ol_layer_Image_, _ol_layer_Layer_);\n\n\n/**\n * Return the associated {@link ol.source.Image source} of the image layer.\n * @function\n * @return {ol.source.Image} Source.\n * @api\n */\n_ol_layer_Image_.prototype.getSource;\nexport default _ol_layer_Image_;\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('el-breadcrumb',{attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: '/home' }}},[_vm._v(\"\")]),_c('el-breadcrumb-item',[_vm._v(\"\")]),_c('el-breadcrumb-item',[_vm._v(\"\")])],1),_c('el-card',[_c('el-row',[_c('el-col',{attrs:{\"span\":10}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":4,\"placeholder\":\"WKT\"},model:{value:(_vm.geom1),callback:function ($$v) {_vm.geom1=$$v},expression:\"geom1\"}})],1),_c('el-col',{attrs:{\"span\":10}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":4,\"placeholder\":\"\"},model:{value:(_vm.geom),callback:function ($$v) {_vm.geom=$$v},expression:\"geom\"}})],1),_c('el-col',{attrs:{\"span\":4}},[_c('el-input-number',{attrs:{\"min\":0,\"label\":\"\"},model:{value:(_vm.distance),callback:function ($$v) {_vm.distance=$$v},expression:\"distance\"}}),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.analysis}},[_vm._v(\"\")])],1)],1),_c('div',{attrs:{\"id\":\"map\"}})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <!---->\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item :to=\"{ path: '/home' }\"></el-breadcrumb-item>\r\n      <el-breadcrumb-item></el-breadcrumb-item>\r\n      <el-breadcrumb-item></el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <!---->\r\n    <el-card>\r\n      <el-row>\r\n        <el-col :span=\"10\">\r\n          <el-input type=\"textarea\" :rows=\"4\" placeholder=\"WKT\" v-model=\"geom1\"></el-input>\r\n        </el-col>\r\n        <el-col :span=\"10\">\r\n          <el-input type=\"textarea\" :rows=\"4\" placeholder=\"\" v-model=\"geom\"></el-input>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <el-input-number v-model=\"distance\" :min=\"0\" label=\"\"></el-input-number>\r\n          <el-button type=\"primary\" @click=\"analysis\"></el-button>\r\n        </el-col>\r\n      </el-row>\r\n      <div id=\"map\"></div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {getTdtLayer, styleFunction} from \"../../utils/searchUtils\";\r\nimport Map from 'ol/map';\r\nimport View from 'ol/view';\r\nimport Feature from 'ol/feature';\r\nimport Point from 'ol/geom/point';\r\nimport TileLayer from 'ol/layer/tile';\r\nimport ImageLayer from 'ol/layer/image';\r\nimport VectorLayer from 'ol/layer/vector';\r\nimport GroupLayer from 'ol/layer/group';\r\nimport TileGrid from 'ol/tilegrid/tilegrid';\r\nimport WMTSGrid from 'ol/tilegrid/wmts';\r\nimport OSM from \"ol/source/osm\";\r\nimport XYZ from 'ol/source/xyz';\r\nimport TileImage from 'ol/source/tileimage';\r\nimport ImageWMS from 'ol/source/imagewms';\r\nimport TileWMS from 'ol/source/tilewms';\r\nimport WMTS from 'ol/source/wmts';\r\nimport Vector from 'ol/source/vector';\r\nimport GeoJSON from 'ol/format/geojson';\r\nimport WKT from 'ol/format/wkt';\r\nimport WFS from 'ol/format/wfs';\r\nimport Draw from 'ol/interaction/draw';\r\nimport Select from 'ol/interaction/select';\r\nimport Modify from 'ol/interaction/modify';\r\nimport Style from 'ol/style/style';\r\nimport Icon from 'ol/style/icon';\r\nimport Stroke from 'ol/style/stroke';\r\nimport Text from 'ol/style/text';\r\nimport Fill from 'ol/style/fill';\r\nimport Circle from 'ol/style/circle';\r\nimport proj from 'ol/proj';\r\nimport extent from 'ol/extent';\r\nimport control from 'ol/control';\r\nimport loadingstrategy from 'ol/loadingstrategy';\r\nexport default {\r\n  data() {\r\n    return {\r\n      geom1: \"POLYGON((100.02715479879 32.168082192159,102.76873121104 37.194305614622,107.0334056301 34.909658604412,105.96723702534 30.949603786713,100.02715479879 32.168082192159))\",\r\n      distance: 0.5,\r\n      geom:'',\r\n      map: null,\r\n      source:null\r\n    }\r\n  },\r\n  created() {\r\n  },\r\n  mounted() {\r\n    this.initMap()\r\n  },\r\n  methods: {\r\n    initMap() {\r\n      let view = new View({\r\n        zoom: 4,\r\n        center: proj.fromLonLat([110, 39])\r\n      });\r\n\r\n      let source = new Vector({\r\n        features: []\r\n      });\r\n      let vector = new VectorLayer({\r\n        source: source,\r\n        style: styleFunction\r\n      });\r\n      let map = new Map({\r\n        controls: control.defaults({\r\n          attribution: false\r\n        }).extend([]),\r\n        target: \"map\",\r\n        layers: [\r\n          getTdtLayer('vec_w'),\r\n          getTdtLayer('cva_w'),\r\n          vector\r\n        ],\r\n        view: view\r\n      });\r\n      this.source = source\r\n      this.map = map\r\n    },\r\n    async analysis(){\r\n      if (this.source)\r\n        this.source.clear();\r\n      const { data: res } = await this.$API.buffAnalysis({\r\n          geom:this.geom1,\r\n          distance:this.distance\r\n        })\r\n      if(!res.success) {\r\n        this.geom = res.msg\r\n      }\r\n      this.geom = res.data\r\n      let wkts = [this.geom1,this.geom];\r\n      let features = [];\r\n      let wktformat = new WKT();\r\n      for (let i = 0; i < wkts.length; i++) {\r\n        let feature = wktformat.readFeature(wkts[i]);\r\n        feature.getGeometry().transform(\"EPSG:4326\", \"EPSG:3857\");\r\n        if (i === 2) feature.set(\"index\", i);\r\n        features.push(feature);\r\n      }\r\n      this.source.addFeatures(features);\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n#map{\r\n  height: 1000px;\r\n}\r\n.el-row {\r\n  margin-bottom: 5px;\r\n&:last-child {\r\n   margin-bottom: 0;\r\n }\r\n}\r\n.el-col {\r\n  border-radius: 4px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BuffAnalysis.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BuffAnalysis.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BuffAnalysis.vue?vue&type=template&id=1f3af891&\"\nimport script from \"./BuffAnalysis.vue?vue&type=script&lang=js&\"\nexport * from \"./BuffAnalysis.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BuffAnalysis.vue?vue&type=style&index=0&id=1f3af891&prod&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/**\n * Available server types: `'carmentaserver'`, `'geoserver'`, `'mapserver'`,\n *     `'qgis'`. These are servers that have vendor parameters beyond the WMS\n *     specification that OpenLayers can make use of.\n * @enum {string}\n */\nvar _ol_source_WMSServerType_ = {\n  CARMENTA_SERVER: 'carmentaserver',\n  GEOSERVER: 'geoserver',\n  MAPSERVER: 'mapserver',\n  QGIS: 'qgis'\n};\n\nexport default _ol_source_WMSServerType_;\n","import _ol_ from './index.js';\nimport _ol_ImageBase_ from './imagebase.js';\nimport _ol_ImageState_ from './imagestate.js';\nimport _ol_events_ from './events.js';\nimport _ol_events_EventType_ from './events/eventtype.js';\nimport _ol_extent_ from './extent.js';\n\n/**\n * @constructor\n * @extends {ol.ImageBase}\n * @param {ol.Extent} extent Extent.\n * @param {number|undefined} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {string} src Image source URI.\n * @param {?string} crossOrigin Cross origin.\n * @param {ol.ImageLoadFunctionType} imageLoadFunction Image load function.\n */\nvar _ol_Image_ = function(extent, resolution, pixelRatio, src, crossOrigin, imageLoadFunction) {\n\n  _ol_ImageBase_.call(this, extent, resolution, pixelRatio, _ol_ImageState_.IDLE);\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.src_ = src;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|Image|HTMLVideoElement}\n   */\n  this.image_ = new Image();\n  if (crossOrigin !== null) {\n    this.image_.crossOrigin = crossOrigin;\n  }\n\n  /**\n   * @private\n   * @type {Array.<ol.EventsKey>}\n   */\n  this.imageListenerKeys_ = null;\n\n  /**\n   * @protected\n   * @type {ol.ImageState}\n   */\n  this.state = _ol_ImageState_.IDLE;\n\n  /**\n   * @private\n   * @type {ol.ImageLoadFunctionType}\n   */\n  this.imageLoadFunction_ = imageLoadFunction;\n\n};\n\n_ol_.inherits(_ol_Image_, _ol_ImageBase_);\n\n\n/**\n * @inheritDoc\n * @api\n */\n_ol_Image_.prototype.getImage = function() {\n  return this.image_;\n};\n\n\n/**\n * Tracks loading or read errors.\n *\n * @private\n */\n_ol_Image_.prototype.handleImageError_ = function() {\n  this.state = _ol_ImageState_.ERROR;\n  this.unlistenImage_();\n  this.changed();\n};\n\n\n/**\n * Tracks successful image load.\n *\n * @private\n */\n_ol_Image_.prototype.handleImageLoad_ = function() {\n  if (this.resolution === undefined) {\n    this.resolution = _ol_extent_.getHeight(this.extent) / this.image_.height;\n  }\n  this.state = _ol_ImageState_.LOADED;\n  this.unlistenImage_();\n  this.changed();\n};\n\n\n/**\n * Load the image or retry if loading previously failed.\n * Loading is taken care of by the tile queue, and calling this method is\n * only needed for preloading or for reloading in case of an error.\n * @override\n * @api\n */\n_ol_Image_.prototype.load = function() {\n  if (this.state == _ol_ImageState_.IDLE || this.state == _ol_ImageState_.ERROR) {\n    this.state = _ol_ImageState_.LOADING;\n    this.changed();\n    this.imageListenerKeys_ = [\n      _ol_events_.listenOnce(this.image_, _ol_events_EventType_.ERROR,\n          this.handleImageError_, this),\n      _ol_events_.listenOnce(this.image_, _ol_events_EventType_.LOAD,\n          this.handleImageLoad_, this)\n    ];\n    this.imageLoadFunction_(this, this.src_);\n  }\n};\n\n\n/**\n * @param {HTMLCanvasElement|Image|HTMLVideoElement} image Image.\n */\n_ol_Image_.prototype.setImage = function(image) {\n  this.image_ = image;\n};\n\n\n/**\n * Discards event handlers which listen for load completion or errors.\n *\n * @private\n */\n_ol_Image_.prototype.unlistenImage_ = function() {\n  this.imageListenerKeys_.forEach(_ol_events_.unlistenByKey);\n  this.imageListenerKeys_ = null;\n};\nexport default _ol_Image_;\n","import _ol_ from '../index.js';\nimport _ol_ImageBase_ from '../imagebase.js';\nimport _ol_ImageState_ from '../imagestate.js';\nimport _ol_events_ from '../events.js';\nimport _ol_events_EventType_ from '../events/eventtype.js';\nimport _ol_extent_ from '../extent.js';\nimport _ol_reproj_ from '../reproj.js';\nimport _ol_reproj_Triangulation_ from '../reproj/triangulation.js';\n\n/**\n * @classdesc\n * Class encapsulating single reprojected image.\n * See {@link ol.source.Image}.\n *\n * @constructor\n * @extends {ol.ImageBase}\n * @param {ol.proj.Projection} sourceProj Source projection (of the data).\n * @param {ol.proj.Projection} targetProj Target projection.\n * @param {ol.Extent} targetExtent Target extent.\n * @param {number} targetResolution Target resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {ol.ReprojImageFunctionType} getImageFunction\n *     Function returning source images (extent, resolution, pixelRatio).\n */\nvar _ol_reproj_Image_ = function(sourceProj, targetProj,\n    targetExtent, targetResolution, pixelRatio, getImageFunction) {\n\n  /**\n   * @private\n   * @type {ol.proj.Projection}\n   */\n  this.targetProj_ = targetProj;\n\n  /**\n   * @private\n   * @type {ol.Extent}\n   */\n  this.maxSourceExtent_ = sourceProj.getExtent();\n  var maxTargetExtent = targetProj.getExtent();\n\n  var limitedTargetExtent = maxTargetExtent ?\n    _ol_extent_.getIntersection(targetExtent, maxTargetExtent) : targetExtent;\n\n  var targetCenter = _ol_extent_.getCenter(limitedTargetExtent);\n  var sourceResolution = _ol_reproj_.calculateSourceResolution(\n      sourceProj, targetProj, targetCenter, targetResolution);\n\n  var errorThresholdInPixels = _ol_.DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD;\n\n  /**\n   * @private\n   * @type {!ol.reproj.Triangulation}\n   */\n  this.triangulation_ = new _ol_reproj_Triangulation_(\n      sourceProj, targetProj, limitedTargetExtent, this.maxSourceExtent_,\n      sourceResolution * errorThresholdInPixels);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.targetResolution_ = targetResolution;\n\n  /**\n   * @private\n   * @type {ol.Extent}\n   */\n  this.targetExtent_ = targetExtent;\n\n  var sourceExtent = this.triangulation_.calculateSourceExtent();\n\n  /**\n   * @private\n   * @type {ol.ImageBase}\n   */\n  this.sourceImage_ =\n      getImageFunction(sourceExtent, sourceResolution, pixelRatio);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.sourcePixelRatio_ =\n      this.sourceImage_ ? this.sourceImage_.getPixelRatio() : 1;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = null;\n\n  /**\n   * @private\n   * @type {?ol.EventsKey}\n   */\n  this.sourceListenerKey_ = null;\n\n\n  var state = _ol_ImageState_.LOADED;\n\n  if (this.sourceImage_) {\n    state = _ol_ImageState_.IDLE;\n  }\n\n  _ol_ImageBase_.call(this, targetExtent, targetResolution, this.sourcePixelRatio_, state);\n};\n\n_ol_.inherits(_ol_reproj_Image_, _ol_ImageBase_);\n\n\n/**\n * @inheritDoc\n */\n_ol_reproj_Image_.prototype.disposeInternal = function() {\n  if (this.state == _ol_ImageState_.LOADING) {\n    this.unlistenSource_();\n  }\n  _ol_ImageBase_.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_reproj_Image_.prototype.getImage = function() {\n  return this.canvas_;\n};\n\n\n/**\n * @return {ol.proj.Projection} Projection.\n */\n_ol_reproj_Image_.prototype.getProjection = function() {\n  return this.targetProj_;\n};\n\n\n/**\n * @private\n */\n_ol_reproj_Image_.prototype.reproject_ = function() {\n  var sourceState = this.sourceImage_.getState();\n  if (sourceState == _ol_ImageState_.LOADED) {\n    var width = _ol_extent_.getWidth(this.targetExtent_) / this.targetResolution_;\n    var height =\n        _ol_extent_.getHeight(this.targetExtent_) / this.targetResolution_;\n\n    this.canvas_ = _ol_reproj_.render(width, height, this.sourcePixelRatio_,\n        this.sourceImage_.getResolution(), this.maxSourceExtent_,\n        this.targetResolution_, this.targetExtent_, this.triangulation_, [{\n          extent: this.sourceImage_.getExtent(),\n          image: this.sourceImage_.getImage()\n        }], 0);\n  }\n  this.state = sourceState;\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_reproj_Image_.prototype.load = function() {\n  if (this.state == _ol_ImageState_.IDLE) {\n    this.state = _ol_ImageState_.LOADING;\n    this.changed();\n\n    var sourceState = this.sourceImage_.getState();\n    if (sourceState == _ol_ImageState_.LOADED ||\n        sourceState == _ol_ImageState_.ERROR) {\n      this.reproject_();\n    } else {\n      this.sourceListenerKey_ = _ol_events_.listen(this.sourceImage_,\n          _ol_events_EventType_.CHANGE, function(e) {\n            var sourceState = this.sourceImage_.getState();\n            if (sourceState == _ol_ImageState_.LOADED ||\n                sourceState == _ol_ImageState_.ERROR) {\n              this.unlistenSource_();\n              this.reproject_();\n            }\n          }, this);\n      this.sourceImage_.load();\n    }\n  }\n};\n\n\n/**\n * @private\n */\n_ol_reproj_Image_.prototype.unlistenSource_ = function() {\n  _ol_events_.unlistenByKey(/** @type {!ol.EventsKey} */ (this.sourceListenerKey_));\n  this.sourceListenerKey_ = null;\n};\nexport default _ol_reproj_Image_;\n","import _ol_ from '../index.js';\nimport _ol_ImageState_ from '../imagestate.js';\nimport _ol_array_ from '../array.js';\nimport _ol_events_Event_ from '../events/event.js';\nimport _ol_extent_ from '../extent.js';\nimport _ol_proj_ from '../proj.js';\nimport _ol_reproj_Image_ from '../reproj/image.js';\nimport _ol_source_Source_ from '../source/source.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for sources providing a single image.\n *\n * @constructor\n * @abstract\n * @extends {ol.source.Source}\n * @param {ol.SourceImageOptions} options Single image source options.\n * @api\n */\nvar _ol_source_Image_ = function(options) {\n  _ol_source_Source_.call(this, {\n    attributions: options.attributions,\n    extent: options.extent,\n    logo: options.logo,\n    projection: options.projection,\n    state: options.state\n  });\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.resolutions_ = options.resolutions !== undefined ?\n    options.resolutions : null;\n\n\n  /**\n   * @private\n   * @type {ol.reproj.Image}\n   */\n  this.reprojectedImage_ = null;\n\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.reprojectedRevision_ = 0;\n};\n\n_ol_.inherits(_ol_source_Image_, _ol_source_Source_);\n\n\n/**\n * @return {Array.<number>} Resolutions.\n * @override\n */\n_ol_source_Image_.prototype.getResolutions = function() {\n  return this.resolutions_;\n};\n\n\n/**\n * @protected\n * @param {number} resolution Resolution.\n * @return {number} Resolution.\n */\n_ol_source_Image_.prototype.findNearestResolution = function(resolution) {\n  if (this.resolutions_) {\n    var idx = _ol_array_.linearFindNearest(this.resolutions_, resolution, 0);\n    resolution = this.resolutions_[idx];\n  }\n  return resolution;\n};\n\n\n/**\n * @param {ol.Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {ol.proj.Projection} projection Projection.\n * @return {ol.ImageBase} Single image.\n */\n_ol_source_Image_.prototype.getImage = function(extent, resolution, pixelRatio, projection) {\n  var sourceProjection = this.getProjection();\n  if (!_ol_.ENABLE_RASTER_REPROJECTION ||\n      !sourceProjection ||\n      !projection ||\n      _ol_proj_.equivalent(sourceProjection, projection)) {\n    if (sourceProjection) {\n      projection = sourceProjection;\n    }\n    return this.getImageInternal(extent, resolution, pixelRatio, projection);\n  } else {\n    if (this.reprojectedImage_) {\n      if (this.reprojectedRevision_ == this.getRevision() &&\n          _ol_proj_.equivalent(\n              this.reprojectedImage_.getProjection(), projection) &&\n          this.reprojectedImage_.getResolution() == resolution &&\n          _ol_extent_.equals(this.reprojectedImage_.getExtent(), extent)) {\n        return this.reprojectedImage_;\n      }\n      this.reprojectedImage_.dispose();\n      this.reprojectedImage_ = null;\n    }\n\n    this.reprojectedImage_ = new _ol_reproj_Image_(\n        sourceProjection, projection, extent, resolution, pixelRatio,\n        function(extent, resolution, pixelRatio) {\n          return this.getImageInternal(extent, resolution,\n              pixelRatio, sourceProjection);\n        }.bind(this));\n    this.reprojectedRevision_ = this.getRevision();\n\n    return this.reprojectedImage_;\n  }\n};\n\n\n/**\n * @abstract\n * @param {ol.Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {ol.proj.Projection} projection Projection.\n * @return {ol.ImageBase} Single image.\n * @protected\n */\n_ol_source_Image_.prototype.getImageInternal = function(extent, resolution, pixelRatio, projection) {};\n\n\n/**\n * Handle image change events.\n * @param {ol.events.Event} event Event.\n * @protected\n */\n_ol_source_Image_.prototype.handleImageChange = function(event) {\n  var image = /** @type {ol.Image} */ (event.target);\n  switch (image.getState()) {\n    case _ol_ImageState_.LOADING:\n      this.dispatchEvent(\n          new _ol_source_Image_.Event(_ol_source_Image_.EventType_.IMAGELOADSTART,\n              image));\n      break;\n    case _ol_ImageState_.LOADED:\n      this.dispatchEvent(\n          new _ol_source_Image_.Event(_ol_source_Image_.EventType_.IMAGELOADEND,\n              image));\n      break;\n    case _ol_ImageState_.ERROR:\n      this.dispatchEvent(\n          new _ol_source_Image_.Event(_ol_source_Image_.EventType_.IMAGELOADERROR,\n              image));\n      break;\n    default:\n      // pass\n  }\n};\n\n\n/**\n * Default image load function for image sources that use ol.Image image\n * instances.\n * @param {ol.Image} image Image.\n * @param {string} src Source.\n */\n_ol_source_Image_.defaultImageLoadFunction = function(image, src) {\n  image.getImage().src = src;\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link ol.source.Image} instances are instances of this\n * type.\n *\n * @constructor\n * @extends {ol.events.Event}\n * @implements {oli.source.ImageEvent}\n * @param {string} type Type.\n * @param {ol.Image} image The image.\n */\n_ol_source_Image_.Event = function(type, image) {\n\n  _ol_events_Event_.call(this, type);\n\n  /**\n   * The image related to the event.\n   * @type {ol.Image}\n   * @api\n   */\n  this.image = image;\n\n};\n_ol_.inherits(_ol_source_Image_.Event, _ol_events_Event_);\n\n\n/**\n * @enum {string}\n * @private\n */\n_ol_source_Image_.EventType_ = {\n\n  /**\n   * Triggered when an image starts loading.\n   * @event ol.source.Image.Event#imageloadstart\n   * @api\n   */\n  IMAGELOADSTART: 'imageloadstart',\n\n  /**\n   * Triggered when an image finishes loading.\n   * @event ol.source.Image.Event#imageloadend\n   * @api\n   */\n  IMAGELOADEND: 'imageloadend',\n\n  /**\n   * Triggered if image loading results in an error.\n   * @event ol.source.Image.Event#imageloaderror\n   * @api\n   */\n  IMAGELOADERROR: 'imageloaderror'\n\n};\nexport default _ol_source_Image_;\n","// FIXME cannot be shared between maps with different projections\n\nimport _ol_ from '../index.js';\nimport _ol_Image_ from '../image.js';\nimport _ol_asserts_ from '../asserts.js';\nimport _ol_events_ from '../events.js';\nimport _ol_events_EventType_ from '../events/eventtype.js';\nimport _ol_extent_ from '../extent.js';\nimport _ol_obj_ from '../obj.js';\nimport _ol_proj_ from '../proj.js';\nimport _ol_reproj_ from '../reproj.js';\nimport _ol_source_Image_ from '../source/image.js';\nimport _ol_source_WMSServerType_ from '../source/wmsservertype.js';\nimport _ol_string_ from '../string.js';\nimport _ol_uri_ from '../uri.js';\n\n/**\n * @classdesc\n * Source for WMS servers providing single, untiled images.\n *\n * @constructor\n * @fires ol.source.Image.Event\n * @extends {ol.source.Image}\n * @param {olx.source.ImageWMSOptions=} opt_options Options.\n * @api\n */\nvar _ol_source_ImageWMS_ = function(opt_options) {\n\n  var options = opt_options || {};\n\n  _ol_source_Image_.call(this, {\n    attributions: options.attributions,\n    logo: options.logo,\n    projection: options.projection,\n    resolutions: options.resolutions\n  });\n\n  /**\n   * @private\n   * @type {?string}\n   */\n  this.crossOrigin_ =\n      options.crossOrigin !== undefined ? options.crossOrigin : null;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.url_ = options.url;\n\n  /**\n   * @private\n   * @type {ol.ImageLoadFunctionType}\n   */\n  this.imageLoadFunction_ = options.imageLoadFunction !== undefined ?\n    options.imageLoadFunction : _ol_source_Image_.defaultImageLoadFunction;\n\n  /**\n   * @private\n   * @type {!Object}\n   */\n  this.params_ = options.params || {};\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.v13_ = true;\n  this.updateV13_();\n\n  /**\n   * @private\n   * @type {ol.source.WMSServerType|undefined}\n   */\n  this.serverType_ = /** @type {ol.source.WMSServerType|undefined} */ (options.serverType);\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.hidpi_ = options.hidpi !== undefined ? options.hidpi : true;\n\n  /**\n   * @private\n   * @type {ol.Image}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {ol.Size}\n   */\n  this.imageSize_ = [0, 0];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedRevision_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.ratio_ = options.ratio !== undefined ? options.ratio : 1.5;\n\n};\n\n_ol_.inherits(_ol_source_ImageWMS_, _ol_source_Image_);\n\n\n/**\n * @const\n * @type {ol.Size}\n * @private\n */\n_ol_source_ImageWMS_.GETFEATUREINFO_IMAGE_SIZE_ = [101, 101];\n\n\n/**\n * Return the GetFeatureInfo URL for the passed coordinate, resolution, and\n * projection. Return `undefined` if the GetFeatureInfo URL cannot be\n * constructed.\n * @param {ol.Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {ol.ProjectionLike} projection Projection.\n * @param {!Object} params GetFeatureInfo params. `INFO_FORMAT` at least should\n *     be provided. If `QUERY_LAYERS` is not provided then the layers specified\n *     in the `LAYERS` parameter will be used. `VERSION` should not be\n *     specified here.\n * @return {string|undefined} GetFeatureInfo URL.\n * @api\n */\n_ol_source_ImageWMS_.prototype.getGetFeatureInfoUrl = function(coordinate, resolution, projection, params) {\n  if (this.url_ === undefined) {\n    return undefined;\n  }\n  var projectionObj = _ol_proj_.get(projection);\n  var sourceProjectionObj = this.getProjection();\n\n  if (sourceProjectionObj && sourceProjectionObj !== projectionObj) {\n    resolution = _ol_reproj_.calculateSourceResolution(sourceProjectionObj, projectionObj, coordinate, resolution);\n    coordinate = _ol_proj_.transform(coordinate, projectionObj, sourceProjectionObj);\n  }\n\n  var extent = _ol_extent_.getForViewAndSize(\n      coordinate, resolution, 0,\n      _ol_source_ImageWMS_.GETFEATUREINFO_IMAGE_SIZE_);\n\n  var baseParams = {\n    'SERVICE': 'WMS',\n    'VERSION': _ol_.DEFAULT_WMS_VERSION,\n    'REQUEST': 'GetFeatureInfo',\n    'FORMAT': 'image/png',\n    'TRANSPARENT': true,\n    'QUERY_LAYERS': this.params_['LAYERS']\n  };\n  _ol_obj_.assign(baseParams, this.params_, params);\n\n  var x = Math.floor((coordinate[0] - extent[0]) / resolution);\n  var y = Math.floor((extent[3] - coordinate[1]) / resolution);\n  baseParams[this.v13_ ? 'I' : 'X'] = x;\n  baseParams[this.v13_ ? 'J' : 'Y'] = y;\n\n  return this.getRequestUrl_(\n      extent, _ol_source_ImageWMS_.GETFEATUREINFO_IMAGE_SIZE_,\n      1, sourceProjectionObj || projectionObj, baseParams);\n};\n\n\n/**\n * Get the user-provided params, i.e. those passed to the constructor through\n * the \"params\" option, and possibly updated using the updateParams method.\n * @return {Object} Params.\n * @api\n */\n_ol_source_ImageWMS_.prototype.getParams = function() {\n  return this.params_;\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_source_ImageWMS_.prototype.getImageInternal = function(extent, resolution, pixelRatio, projection) {\n\n  if (this.url_ === undefined) {\n    return null;\n  }\n\n  resolution = this.findNearestResolution(resolution);\n\n  if (pixelRatio != 1 && (!this.hidpi_ || this.serverType_ === undefined)) {\n    pixelRatio = 1;\n  }\n\n  var imageResolution = resolution / pixelRatio;\n\n  var center = _ol_extent_.getCenter(extent);\n  var viewWidth = Math.ceil(_ol_extent_.getWidth(extent) / imageResolution);\n  var viewHeight = Math.ceil(_ol_extent_.getHeight(extent) / imageResolution);\n  var viewExtent = _ol_extent_.getForViewAndSize(center, imageResolution, 0,\n      [viewWidth, viewHeight]);\n  var requestWidth = Math.ceil(this.ratio_ * _ol_extent_.getWidth(extent) / imageResolution);\n  var requestHeight = Math.ceil(this.ratio_ * _ol_extent_.getHeight(extent) / imageResolution);\n  var requestExtent = _ol_extent_.getForViewAndSize(center, imageResolution, 0,\n      [requestWidth, requestHeight]);\n\n  var image = this.image_;\n  if (image &&\n      this.renderedRevision_ == this.getRevision() &&\n      image.getResolution() == resolution &&\n      image.getPixelRatio() == pixelRatio &&\n      _ol_extent_.containsExtent(image.getExtent(), viewExtent)) {\n    return image;\n  }\n\n  var params = {\n    'SERVICE': 'WMS',\n    'VERSION': _ol_.DEFAULT_WMS_VERSION,\n    'REQUEST': 'GetMap',\n    'FORMAT': 'image/png',\n    'TRANSPARENT': true\n  };\n  _ol_obj_.assign(params, this.params_);\n\n  this.imageSize_[0] = Math.round(_ol_extent_.getWidth(requestExtent) / imageResolution);\n  this.imageSize_[1] = Math.round(_ol_extent_.getHeight(requestExtent) / imageResolution);\n\n  var url = this.getRequestUrl_(requestExtent, this.imageSize_, pixelRatio,\n      projection, params);\n\n  this.image_ = new _ol_Image_(requestExtent, resolution, pixelRatio,\n      url, this.crossOrigin_, this.imageLoadFunction_);\n\n  this.renderedRevision_ = this.getRevision();\n\n  _ol_events_.listen(this.image_, _ol_events_EventType_.CHANGE,\n      this.handleImageChange, this);\n\n  return this.image_;\n\n};\n\n\n/**\n * Return the image load function of the source.\n * @return {ol.ImageLoadFunctionType} The image load function.\n * @api\n */\n_ol_source_ImageWMS_.prototype.getImageLoadFunction = function() {\n  return this.imageLoadFunction_;\n};\n\n\n/**\n * @param {ol.Extent} extent Extent.\n * @param {ol.Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {ol.proj.Projection} projection Projection.\n * @param {Object} params Params.\n * @return {string} Request URL.\n * @private\n */\n_ol_source_ImageWMS_.prototype.getRequestUrl_ = function(extent, size, pixelRatio, projection, params) {\n\n  _ol_asserts_.assert(this.url_ !== undefined, 9); // `url` must be configured or set using `#setUrl()`\n\n  params[this.v13_ ? 'CRS' : 'SRS'] = projection.getCode();\n\n  if (!('STYLES' in this.params_)) {\n    params['STYLES'] = '';\n  }\n\n  if (pixelRatio != 1) {\n    switch (this.serverType_) {\n      case _ol_source_WMSServerType_.GEOSERVER:\n        var dpi = (90 * pixelRatio + 0.5) | 0;\n        if ('FORMAT_OPTIONS' in params) {\n          params['FORMAT_OPTIONS'] += ';dpi:' + dpi;\n        } else {\n          params['FORMAT_OPTIONS'] = 'dpi:' + dpi;\n        }\n        break;\n      case _ol_source_WMSServerType_.MAPSERVER:\n        params['MAP_RESOLUTION'] = 90 * pixelRatio;\n        break;\n      case _ol_source_WMSServerType_.CARMENTA_SERVER:\n      case _ol_source_WMSServerType_.QGIS:\n        params['DPI'] = 90 * pixelRatio;\n        break;\n      default:\n        _ol_asserts_.assert(false, 8); // Unknown `serverType` configured\n        break;\n    }\n  }\n\n  params['WIDTH'] = size[0];\n  params['HEIGHT'] = size[1];\n\n  var axisOrientation = projection.getAxisOrientation();\n  var bbox;\n  if (this.v13_ && axisOrientation.substr(0, 2) == 'ne') {\n    bbox = [extent[1], extent[0], extent[3], extent[2]];\n  } else {\n    bbox = extent;\n  }\n  params['BBOX'] = bbox.join(',');\n\n  return _ol_uri_.appendParams(/** @type {string} */ (this.url_), params);\n};\n\n\n/**\n * Return the URL used for this WMS source.\n * @return {string|undefined} URL.\n * @api\n */\n_ol_source_ImageWMS_.prototype.getUrl = function() {\n  return this.url_;\n};\n\n\n/**\n * Set the image load function of the source.\n * @param {ol.ImageLoadFunctionType} imageLoadFunction Image load function.\n * @api\n */\n_ol_source_ImageWMS_.prototype.setImageLoadFunction = function(\n    imageLoadFunction) {\n  this.image_ = null;\n  this.imageLoadFunction_ = imageLoadFunction;\n  this.changed();\n};\n\n\n/**\n * Set the URL to use for requests.\n * @param {string|undefined} url URL.\n * @api\n */\n_ol_source_ImageWMS_.prototype.setUrl = function(url) {\n  if (url != this.url_) {\n    this.url_ = url;\n    this.image_ = null;\n    this.changed();\n  }\n};\n\n\n/**\n * Update the user-provided params.\n * @param {Object} params Params.\n * @api\n */\n_ol_source_ImageWMS_.prototype.updateParams = function(params) {\n  _ol_obj_.assign(this.params_, params);\n  this.updateV13_();\n  this.image_ = null;\n  this.changed();\n};\n\n\n/**\n * @private\n */\n_ol_source_ImageWMS_.prototype.updateV13_ = function() {\n  var version = this.params_['VERSION'] || _ol_.DEFAULT_WMS_VERSION;\n  this.v13_ = _ol_string_.compareVersions(version, '1.3') >= 0;\n};\nexport default _ol_source_ImageWMS_;\n","/**\n * Icon anchor units. One of 'fraction', 'pixels'.\n * @enum {string}\n */\nvar _ol_style_IconAnchorUnits_ = {\n  FRACTION: 'fraction',\n  PIXELS: 'pixels'\n};\n\nexport default _ol_style_IconAnchorUnits_;\n","import _ol_ from '../index.js';\nimport _ol_dom_ from '../dom.js';\nimport _ol_events_ from '../events.js';\nimport _ol_events_EventTarget_ from '../events/eventtarget.js';\nimport _ol_events_EventType_ from '../events/eventtype.js';\nimport _ol_ImageState_ from '../imagestate.js';\nimport _ol_style_ from '../style.js';\n\n/**\n * @constructor\n * @param {Image|HTMLCanvasElement} image Image.\n * @param {string|undefined} src Src.\n * @param {ol.Size} size Size.\n * @param {?string} crossOrigin Cross origin.\n * @param {ol.ImageState} imageState Image state.\n * @param {ol.Color} color Color.\n * @extends {ol.events.EventTarget}\n */\nvar _ol_style_IconImage_ = function(image, src, size, crossOrigin, imageState,\n    color) {\n\n  _ol_events_EventTarget_.call(this);\n\n  /**\n   * @private\n   * @type {Image|HTMLCanvasElement}\n   */\n  this.hitDetectionImage_ = null;\n\n  /**\n   * @private\n   * @type {Image|HTMLCanvasElement}\n   */\n  this.image_ = !image ? new Image() : image;\n\n  if (crossOrigin !== null) {\n    this.image_.crossOrigin = crossOrigin;\n  }\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = color ?\n    /** @type {HTMLCanvasElement} */ (document.createElement('CANVAS')) :\n    null;\n\n  /**\n   * @private\n   * @type {ol.Color}\n   */\n  this.color_ = color;\n\n  /**\n   * @private\n   * @type {Array.<ol.EventsKey>}\n   */\n  this.imageListenerKeys_ = null;\n\n  /**\n   * @private\n   * @type {ol.ImageState}\n   */\n  this.imageState_ = imageState;\n\n  /**\n   * @private\n   * @type {ol.Size}\n   */\n  this.size_ = size;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.src_ = src;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.tainting_ = false;\n  if (this.imageState_ == _ol_ImageState_.LOADED) {\n    this.determineTainting_();\n  }\n\n};\n\n_ol_.inherits(_ol_style_IconImage_, _ol_events_EventTarget_);\n\n\n/**\n * @param {Image|HTMLCanvasElement} image Image.\n * @param {string} src Src.\n * @param {ol.Size} size Size.\n * @param {?string} crossOrigin Cross origin.\n * @param {ol.ImageState} imageState Image state.\n * @param {ol.Color} color Color.\n * @return {ol.style.IconImage} Icon image.\n */\n_ol_style_IconImage_.get = function(image, src, size, crossOrigin, imageState,\n    color) {\n  var iconImageCache = _ol_style_.iconImageCache;\n  var iconImage = iconImageCache.get(src, crossOrigin, color);\n  if (!iconImage) {\n    iconImage = new _ol_style_IconImage_(\n        image, src, size, crossOrigin, imageState, color);\n    iconImageCache.set(src, crossOrigin, color, iconImage);\n  }\n  return iconImage;\n};\n\n\n/**\n * @private\n */\n_ol_style_IconImage_.prototype.determineTainting_ = function() {\n  var context = _ol_dom_.createCanvasContext2D(1, 1);\n  try {\n    context.drawImage(this.image_, 0, 0);\n    context.getImageData(0, 0, 1, 1);\n  } catch (e) {\n    this.tainting_ = true;\n  }\n};\n\n\n/**\n * @private\n */\n_ol_style_IconImage_.prototype.dispatchChangeEvent_ = function() {\n  this.dispatchEvent(_ol_events_EventType_.CHANGE);\n};\n\n\n/**\n * @private\n */\n_ol_style_IconImage_.prototype.handleImageError_ = function() {\n  this.imageState_ = _ol_ImageState_.ERROR;\n  this.unlistenImage_();\n  this.dispatchChangeEvent_();\n};\n\n\n/**\n * @private\n */\n_ol_style_IconImage_.prototype.handleImageLoad_ = function() {\n  this.imageState_ = _ol_ImageState_.LOADED;\n  if (this.size_) {\n    this.image_.width = this.size_[0];\n    this.image_.height = this.size_[1];\n  }\n  this.size_ = [this.image_.width, this.image_.height];\n  this.unlistenImage_();\n  this.determineTainting_();\n  this.replaceColor_();\n  this.dispatchChangeEvent_();\n};\n\n\n/**\n * @param {number} pixelRatio Pixel ratio.\n * @return {Image|HTMLCanvasElement} Image or Canvas element.\n */\n_ol_style_IconImage_.prototype.getImage = function(pixelRatio) {\n  return this.canvas_ ? this.canvas_ : this.image_;\n};\n\n\n/**\n * @return {ol.ImageState} Image state.\n */\n_ol_style_IconImage_.prototype.getImageState = function() {\n  return this.imageState_;\n};\n\n\n/**\n * @param {number} pixelRatio Pixel ratio.\n * @return {Image|HTMLCanvasElement} Image element.\n */\n_ol_style_IconImage_.prototype.getHitDetectionImage = function(pixelRatio) {\n  if (!this.hitDetectionImage_) {\n    if (this.tainting_) {\n      var width = this.size_[0];\n      var height = this.size_[1];\n      var context = _ol_dom_.createCanvasContext2D(width, height);\n      context.fillRect(0, 0, width, height);\n      this.hitDetectionImage_ = context.canvas;\n    } else {\n      this.hitDetectionImage_ = this.image_;\n    }\n  }\n  return this.hitDetectionImage_;\n};\n\n\n/**\n * @return {ol.Size} Image size.\n */\n_ol_style_IconImage_.prototype.getSize = function() {\n  return this.size_;\n};\n\n\n/**\n * @return {string|undefined} Image src.\n */\n_ol_style_IconImage_.prototype.getSrc = function() {\n  return this.src_;\n};\n\n\n/**\n * Load not yet loaded URI.\n */\n_ol_style_IconImage_.prototype.load = function() {\n  if (this.imageState_ == _ol_ImageState_.IDLE) {\n    this.imageState_ = _ol_ImageState_.LOADING;\n    this.imageListenerKeys_ = [\n      _ol_events_.listenOnce(this.image_, _ol_events_EventType_.ERROR,\n          this.handleImageError_, this),\n      _ol_events_.listenOnce(this.image_, _ol_events_EventType_.LOAD,\n          this.handleImageLoad_, this)\n    ];\n    try {\n      this.image_.src = this.src_;\n    } catch (e) {\n      this.handleImageError_();\n    }\n  }\n};\n\n\n/**\n * @private\n */\n_ol_style_IconImage_.prototype.replaceColor_ = function() {\n  if (this.tainting_ || this.color_ === null) {\n    return;\n  }\n\n  this.canvas_.width = this.image_.width;\n  this.canvas_.height = this.image_.height;\n\n  var ctx = this.canvas_.getContext('2d');\n  ctx.drawImage(this.image_, 0, 0);\n\n  var imgData = ctx.getImageData(0, 0, this.image_.width, this.image_.height);\n  var data = imgData.data;\n  var r = this.color_[0] / 255.0;\n  var g = this.color_[1] / 255.0;\n  var b = this.color_[2] / 255.0;\n\n  for (var i = 0, ii = data.length; i < ii; i += 4) {\n    data[i] *= r;\n    data[i + 1] *= g;\n    data[i + 2] *= b;\n  }\n  ctx.putImageData(imgData, 0, 0);\n};\n\n\n/**\n * Discards event handlers which listen for load completion or errors.\n *\n * @private\n */\n_ol_style_IconImage_.prototype.unlistenImage_ = function() {\n  this.imageListenerKeys_.forEach(_ol_events_.unlistenByKey);\n  this.imageListenerKeys_ = null;\n};\nexport default _ol_style_IconImage_;\n","/**\n * Icon origin. One of 'bottom-left', 'bottom-right', 'top-left', 'top-right'.\n * @enum {string}\n */\nvar _ol_style_IconOrigin_ = {\n  BOTTOM_LEFT: 'bottom-left',\n  BOTTOM_RIGHT: 'bottom-right',\n  TOP_LEFT: 'top-left',\n  TOP_RIGHT: 'top-right'\n};\n\nexport default _ol_style_IconOrigin_;\n","import _ol_ from '../index.js';\nimport _ol_ImageState_ from '../imagestate.js';\nimport _ol_asserts_ from '../asserts.js';\nimport _ol_color_ from '../color.js';\nimport _ol_events_ from '../events.js';\nimport _ol_events_EventType_ from '../events/eventtype.js';\nimport _ol_style_IconAnchorUnits_ from '../style/iconanchorunits.js';\nimport _ol_style_IconImage_ from '../style/iconimage.js';\nimport _ol_style_IconOrigin_ from '../style/iconorigin.js';\nimport _ol_style_Image_ from '../style/image.js';\n\n/**\n * @classdesc\n * Set icon style for vector features.\n *\n * @constructor\n * @param {olx.style.IconOptions=} opt_options Options.\n * @extends {ol.style.Image}\n * @api\n */\nvar _ol_style_Icon_ = function(opt_options) {\n\n  var options = opt_options || {};\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.anchor_ = options.anchor !== undefined ? options.anchor : [0.5, 0.5];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.normalizedAnchor_ = null;\n\n  /**\n   * @private\n   * @type {ol.style.IconOrigin}\n   */\n  this.anchorOrigin_ = options.anchorOrigin !== undefined ?\n    options.anchorOrigin : _ol_style_IconOrigin_.TOP_LEFT;\n\n  /**\n   * @private\n   * @type {ol.style.IconAnchorUnits}\n   */\n  this.anchorXUnits_ = options.anchorXUnits !== undefined ?\n    options.anchorXUnits : _ol_style_IconAnchorUnits_.FRACTION;\n\n  /**\n   * @private\n   * @type {ol.style.IconAnchorUnits}\n   */\n  this.anchorYUnits_ = options.anchorYUnits !== undefined ?\n    options.anchorYUnits : _ol_style_IconAnchorUnits_.FRACTION;\n\n  /**\n   * @private\n   * @type {?string}\n   */\n  this.crossOrigin_ =\n      options.crossOrigin !== undefined ? options.crossOrigin : null;\n\n  /**\n   * @type {Image|HTMLCanvasElement}\n   */\n  var image = options.img !== undefined ? options.img : null;\n\n  /**\n   * @type {ol.Size}\n   */\n  var imgSize = options.imgSize !== undefined ? options.imgSize : null;\n\n  /**\n   * @type {string|undefined}\n   */\n  var src = options.src;\n\n  _ol_asserts_.assert(!(src !== undefined && image),\n      4); // `image` and `src` cannot be provided at the same time\n  _ol_asserts_.assert(!image || (image && imgSize),\n      5); // `imgSize` must be set when `image` is provided\n\n  if ((src === undefined || src.length === 0) && image) {\n    src = image.src || _ol_.getUid(image).toString();\n  }\n  _ol_asserts_.assert(src !== undefined && src.length > 0,\n      6); // A defined and non-empty `src` or `image` must be provided\n\n  /**\n   * @type {ol.ImageState}\n   */\n  var imageState = options.src !== undefined ?\n    _ol_ImageState_.IDLE : _ol_ImageState_.LOADED;\n\n  /**\n   * @private\n   * @type {ol.Color}\n   */\n  this.color_ = options.color !== undefined ? _ol_color_.asArray(options.color) :\n    null;\n\n  /**\n   * @private\n   * @type {ol.style.IconImage}\n   */\n  this.iconImage_ = _ol_style_IconImage_.get(\n      image, /** @type {string} */ (src), imgSize, this.crossOrigin_, imageState, this.color_);\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.offset_ = options.offset !== undefined ? options.offset : [0, 0];\n\n  /**\n   * @private\n   * @type {ol.style.IconOrigin}\n   */\n  this.offsetOrigin_ = options.offsetOrigin !== undefined ?\n    options.offsetOrigin : _ol_style_IconOrigin_.TOP_LEFT;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.origin_ = null;\n\n  /**\n   * @private\n   * @type {ol.Size}\n   */\n  this.size_ = options.size !== undefined ? options.size : null;\n\n  /**\n   * @type {number}\n   */\n  var opacity = options.opacity !== undefined ? options.opacity : 1;\n\n  /**\n   * @type {boolean}\n   */\n  var rotateWithView = options.rotateWithView !== undefined ?\n    options.rotateWithView : false;\n\n  /**\n   * @type {number}\n   */\n  var rotation = options.rotation !== undefined ? options.rotation : 0;\n\n  /**\n   * @type {number}\n   */\n  var scale = options.scale !== undefined ? options.scale : 1;\n\n  /**\n   * @type {boolean}\n   */\n  var snapToPixel = options.snapToPixel !== undefined ?\n    options.snapToPixel : true;\n\n  _ol_style_Image_.call(this, {\n    opacity: opacity,\n    rotation: rotation,\n    scale: scale,\n    snapToPixel: snapToPixel,\n    rotateWithView: rotateWithView\n  });\n\n};\n\n_ol_.inherits(_ol_style_Icon_, _ol_style_Image_);\n\n\n/**\n * Clones the style. The underlying Image/HTMLCanvasElement is not cloned.\n * @return {ol.style.Icon} The cloned style.\n * @api\n */\n_ol_style_Icon_.prototype.clone = function() {\n  return new _ol_style_Icon_({\n    anchor: this.anchor_.slice(),\n    anchorOrigin: this.anchorOrigin_,\n    anchorXUnits: this.anchorXUnits_,\n    anchorYUnits: this.anchorYUnits_,\n    crossOrigin: this.crossOrigin_,\n    color: (this.color_ && this.color_.slice) ? this.color_.slice() : this.color_ || undefined,\n    src: this.getSrc(),\n    offset: this.offset_.slice(),\n    offsetOrigin: this.offsetOrigin_,\n    size: this.size_ !== null ? this.size_.slice() : undefined,\n    opacity: this.getOpacity(),\n    scale: this.getScale(),\n    snapToPixel: this.getSnapToPixel(),\n    rotation: this.getRotation(),\n    rotateWithView: this.getRotateWithView()\n  });\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\n_ol_style_Icon_.prototype.getAnchor = function() {\n  if (this.normalizedAnchor_) {\n    return this.normalizedAnchor_;\n  }\n  var anchor = this.anchor_;\n  var size = this.getSize();\n  if (this.anchorXUnits_ == _ol_style_IconAnchorUnits_.FRACTION ||\n      this.anchorYUnits_ == _ol_style_IconAnchorUnits_.FRACTION) {\n    if (!size) {\n      return null;\n    }\n    anchor = this.anchor_.slice();\n    if (this.anchorXUnits_ == _ol_style_IconAnchorUnits_.FRACTION) {\n      anchor[0] *= size[0];\n    }\n    if (this.anchorYUnits_ == _ol_style_IconAnchorUnits_.FRACTION) {\n      anchor[1] *= size[1];\n    }\n  }\n\n  if (this.anchorOrigin_ != _ol_style_IconOrigin_.TOP_LEFT) {\n    if (!size) {\n      return null;\n    }\n    if (anchor === this.anchor_) {\n      anchor = this.anchor_.slice();\n    }\n    if (this.anchorOrigin_ == _ol_style_IconOrigin_.TOP_RIGHT ||\n        this.anchorOrigin_ == _ol_style_IconOrigin_.BOTTOM_RIGHT) {\n      anchor[0] = -anchor[0] + size[0];\n    }\n    if (this.anchorOrigin_ == _ol_style_IconOrigin_.BOTTOM_LEFT ||\n        this.anchorOrigin_ == _ol_style_IconOrigin_.BOTTOM_RIGHT) {\n      anchor[1] = -anchor[1] + size[1];\n    }\n  }\n  this.normalizedAnchor_ = anchor;\n  return this.normalizedAnchor_;\n};\n\n\n/**\n * Get the icon color.\n * @return {ol.Color} Color.\n * @api\n */\n_ol_style_Icon_.prototype.getColor = function() {\n  return this.color_;\n};\n\n\n/**\n * Get the image icon.\n * @param {number} pixelRatio Pixel ratio.\n * @return {Image|HTMLCanvasElement} Image or Canvas element.\n * @override\n * @api\n */\n_ol_style_Icon_.prototype.getImage = function(pixelRatio) {\n  return this.iconImage_.getImage(pixelRatio);\n};\n\n\n/**\n * @override\n */\n_ol_style_Icon_.prototype.getImageSize = function() {\n  return this.iconImage_.getSize();\n};\n\n\n/**\n * @override\n */\n_ol_style_Icon_.prototype.getHitDetectionImageSize = function() {\n  return this.getImageSize();\n};\n\n\n/**\n * @override\n */\n_ol_style_Icon_.prototype.getImageState = function() {\n  return this.iconImage_.getImageState();\n};\n\n\n/**\n * @override\n */\n_ol_style_Icon_.prototype.getHitDetectionImage = function(pixelRatio) {\n  return this.iconImage_.getHitDetectionImage(pixelRatio);\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\n_ol_style_Icon_.prototype.getOrigin = function() {\n  if (this.origin_) {\n    return this.origin_;\n  }\n  var offset = this.offset_;\n\n  if (this.offsetOrigin_ != _ol_style_IconOrigin_.TOP_LEFT) {\n    var size = this.getSize();\n    var iconImageSize = this.iconImage_.getSize();\n    if (!size || !iconImageSize) {\n      return null;\n    }\n    offset = offset.slice();\n    if (this.offsetOrigin_ == _ol_style_IconOrigin_.TOP_RIGHT ||\n        this.offsetOrigin_ == _ol_style_IconOrigin_.BOTTOM_RIGHT) {\n      offset[0] = iconImageSize[0] - size[0] - offset[0];\n    }\n    if (this.offsetOrigin_ == _ol_style_IconOrigin_.BOTTOM_LEFT ||\n        this.offsetOrigin_ == _ol_style_IconOrigin_.BOTTOM_RIGHT) {\n      offset[1] = iconImageSize[1] - size[1] - offset[1];\n    }\n  }\n  this.origin_ = offset;\n  return this.origin_;\n};\n\n\n/**\n * Get the image URL.\n * @return {string|undefined} Image src.\n * @api\n */\n_ol_style_Icon_.prototype.getSrc = function() {\n  return this.iconImage_.getSrc();\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\n_ol_style_Icon_.prototype.getSize = function() {\n  return !this.size_ ? this.iconImage_.getSize() : this.size_;\n};\n\n\n/**\n * @override\n */\n_ol_style_Icon_.prototype.listenImageChange = function(listener, thisArg) {\n  return _ol_events_.listen(this.iconImage_, _ol_events_EventType_.CHANGE,\n      listener, thisArg);\n};\n\n\n/**\n * Load not yet loaded URI.\n * When rendering a feature with an icon style, the vector renderer will\n * automatically call this method. However, you might want to call this\n * method yourself for preloading or other purposes.\n * @override\n * @api\n */\n_ol_style_Icon_.prototype.load = function() {\n  this.iconImage_.load();\n};\n\n\n/**\n * @override\n */\n_ol_style_Icon_.prototype.unlistenImageChange = function(listener, thisArg) {\n  _ol_events_.unlisten(this.iconImage_, _ol_events_EventType_.CHANGE,\n      listener, thisArg);\n};\nexport default _ol_style_Icon_;\n","import _ol_ from '../index.js';\nimport _ol_format_Feature_ from '../format/feature.js';\nimport _ol_format_FormatType_ from '../format/formattype.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for text feature formats.\n *\n * @constructor\n * @abstract\n * @extends {ol.format.Feature}\n */\nvar _ol_format_TextFeature_ = function() {\n  _ol_format_Feature_.call(this);\n};\n\n_ol_.inherits(_ol_format_TextFeature_, _ol_format_Feature_);\n\n\n/**\n * @param {Document|Node|Object|string} source Source.\n * @private\n * @return {string} Text.\n */\n_ol_format_TextFeature_.prototype.getText_ = function(source) {\n  if (typeof source === 'string') {\n    return source;\n  } else {\n    return '';\n  }\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_format_TextFeature_.prototype.getType = function() {\n  return _ol_format_FormatType_.TEXT;\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_format_TextFeature_.prototype.readFeature = function(source, opt_options) {\n  return this.readFeatureFromText(\n      this.getText_(source), this.adaptOptions(opt_options));\n};\n\n\n/**\n * @abstract\n * @param {string} text Text.\n * @param {olx.format.ReadOptions=} opt_options Read options.\n * @protected\n * @return {ol.Feature} Feature.\n */\n_ol_format_TextFeature_.prototype.readFeatureFromText = function(text, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\n_ol_format_TextFeature_.prototype.readFeatures = function(source, opt_options) {\n  return this.readFeaturesFromText(\n      this.getText_(source), this.adaptOptions(opt_options));\n};\n\n\n/**\n * @abstract\n * @param {string} text Text.\n * @param {olx.format.ReadOptions=} opt_options Read options.\n * @protected\n * @return {Array.<ol.Feature>} Features.\n */\n_ol_format_TextFeature_.prototype.readFeaturesFromText = function(text, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\n_ol_format_TextFeature_.prototype.readGeometry = function(source, opt_options) {\n  return this.readGeometryFromText(\n      this.getText_(source), this.adaptOptions(opt_options));\n};\n\n\n/**\n * @abstract\n * @param {string} text Text.\n * @param {olx.format.ReadOptions=} opt_options Read options.\n * @protected\n * @return {ol.geom.Geometry} Geometry.\n */\n_ol_format_TextFeature_.prototype.readGeometryFromText = function(text, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\n_ol_format_TextFeature_.prototype.readProjection = function(source) {\n  return this.readProjectionFromText(this.getText_(source));\n};\n\n\n/**\n * @param {string} text Text.\n * @protected\n * @return {ol.proj.Projection} Projection.\n */\n_ol_format_TextFeature_.prototype.readProjectionFromText = function(text) {\n  return this.defaultDataProjection;\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_format_TextFeature_.prototype.writeFeature = function(feature, opt_options) {\n  return this.writeFeatureText(feature, this.adaptOptions(opt_options));\n};\n\n\n/**\n * @abstract\n * @param {ol.Feature} feature Features.\n * @param {olx.format.WriteOptions=} opt_options Write options.\n * @protected\n * @return {string} Text.\n */\n_ol_format_TextFeature_.prototype.writeFeatureText = function(feature, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\n_ol_format_TextFeature_.prototype.writeFeatures = function(\n    features, opt_options) {\n  return this.writeFeaturesText(features, this.adaptOptions(opt_options));\n};\n\n\n/**\n * @abstract\n * @param {Array.<ol.Feature>} features Features.\n * @param {olx.format.WriteOptions=} opt_options Write options.\n * @protected\n * @return {string} Text.\n */\n_ol_format_TextFeature_.prototype.writeFeaturesText = function(features, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\n_ol_format_TextFeature_.prototype.writeGeometry = function(\n    geometry, opt_options) {\n  return this.writeGeometryText(geometry, this.adaptOptions(opt_options));\n};\n\n\n/**\n * @abstract\n * @param {ol.geom.Geometry} geometry Geometry.\n * @param {olx.format.WriteOptions=} opt_options Write options.\n * @protected\n * @return {string} Text.\n */\n_ol_format_TextFeature_.prototype.writeGeometryText = function(geometry, opt_options) {};\nexport default _ol_format_TextFeature_;\n","import _ol_ from '../index.js';\nimport _ol_Feature_ from '../feature.js';\nimport _ol_format_Feature_ from '../format/feature.js';\nimport _ol_format_TextFeature_ from '../format/textfeature.js';\nimport _ol_geom_GeometryCollection_ from '../geom/geometrycollection.js';\nimport _ol_geom_GeometryType_ from '../geom/geometrytype.js';\nimport _ol_geom_GeometryLayout_ from '../geom/geometrylayout.js';\nimport _ol_geom_LineString_ from '../geom/linestring.js';\nimport _ol_geom_MultiLineString_ from '../geom/multilinestring.js';\nimport _ol_geom_MultiPoint_ from '../geom/multipoint.js';\nimport _ol_geom_MultiPolygon_ from '../geom/multipolygon.js';\nimport _ol_geom_Point_ from '../geom/point.js';\nimport _ol_geom_Polygon_ from '../geom/polygon.js';\nimport _ol_geom_SimpleGeometry_ from '../geom/simplegeometry.js';\n\n/**\n * @classdesc\n * Geometry format for reading and writing data in the `WellKnownText` (WKT)\n * format.\n *\n * @constructor\n * @extends {ol.format.TextFeature}\n * @param {olx.format.WKTOptions=} opt_options Options.\n * @api\n */\nvar _ol_format_WKT_ = function(opt_options) {\n\n  var options = opt_options ? opt_options : {};\n\n  _ol_format_TextFeature_.call(this);\n\n  /**\n   * Split GeometryCollection into multiple features.\n   * @type {boolean}\n   * @private\n   */\n  this.splitCollection_ = options.splitCollection !== undefined ?\n    options.splitCollection : false;\n\n};\n\n_ol_.inherits(_ol_format_WKT_, _ol_format_TextFeature_);\n\n\n/**\n * @const\n * @type {string}\n */\n_ol_format_WKT_.EMPTY = 'EMPTY';\n\n\n/**\n * @const\n * @type {string}\n */\n_ol_format_WKT_.Z = 'Z';\n\n\n/**\n * @const\n * @type {string}\n */\n_ol_format_WKT_.M = 'M';\n\n\n/**\n * @const\n * @type {string}\n */\n_ol_format_WKT_.ZM = 'ZM';\n\n\n/**\n * @param {ol.geom.Point} geom Point geometry.\n * @return {string} Coordinates part of Point as WKT.\n * @private\n */\n_ol_format_WKT_.encodePointGeometry_ = function(geom) {\n  var coordinates = geom.getCoordinates();\n  if (coordinates.length === 0) {\n    return '';\n  }\n  return coordinates.join(' ');\n};\n\n\n/**\n * @param {ol.geom.MultiPoint} geom MultiPoint geometry.\n * @return {string} Coordinates part of MultiPoint as WKT.\n * @private\n */\n_ol_format_WKT_.encodeMultiPointGeometry_ = function(geom) {\n  var array = [];\n  var components = geom.getPoints();\n  for (var i = 0, ii = components.length; i < ii; ++i) {\n    array.push('(' + _ol_format_WKT_.encodePointGeometry_(components[i]) + ')');\n  }\n  return array.join(',');\n};\n\n\n/**\n * @param {ol.geom.GeometryCollection} geom GeometryCollection geometry.\n * @return {string} Coordinates part of GeometryCollection as WKT.\n * @private\n */\n_ol_format_WKT_.encodeGeometryCollectionGeometry_ = function(geom) {\n  var array = [];\n  var geoms = geom.getGeometries();\n  for (var i = 0, ii = geoms.length; i < ii; ++i) {\n    array.push(_ol_format_WKT_.encode_(geoms[i]));\n  }\n  return array.join(',');\n};\n\n\n/**\n * @param {ol.geom.LineString|ol.geom.LinearRing} geom LineString geometry.\n * @return {string} Coordinates part of LineString as WKT.\n * @private\n */\n_ol_format_WKT_.encodeLineStringGeometry_ = function(geom) {\n  var coordinates = geom.getCoordinates();\n  var array = [];\n  for (var i = 0, ii = coordinates.length; i < ii; ++i) {\n    array.push(coordinates[i].join(' '));\n  }\n  return array.join(',');\n};\n\n\n/**\n * @param {ol.geom.MultiLineString} geom MultiLineString geometry.\n * @return {string} Coordinates part of MultiLineString as WKT.\n * @private\n */\n_ol_format_WKT_.encodeMultiLineStringGeometry_ = function(geom) {\n  var array = [];\n  var components = geom.getLineStrings();\n  for (var i = 0, ii = components.length; i < ii; ++i) {\n    array.push('(' + _ol_format_WKT_.encodeLineStringGeometry_(\n        components[i]) + ')');\n  }\n  return array.join(',');\n};\n\n\n/**\n * @param {ol.geom.Polygon} geom Polygon geometry.\n * @return {string} Coordinates part of Polygon as WKT.\n * @private\n */\n_ol_format_WKT_.encodePolygonGeometry_ = function(geom) {\n  var array = [];\n  var rings = geom.getLinearRings();\n  for (var i = 0, ii = rings.length; i < ii; ++i) {\n    array.push('(' + _ol_format_WKT_.encodeLineStringGeometry_(\n        rings[i]) + ')');\n  }\n  return array.join(',');\n};\n\n\n/**\n * @param {ol.geom.MultiPolygon} geom MultiPolygon geometry.\n * @return {string} Coordinates part of MultiPolygon as WKT.\n * @private\n */\n_ol_format_WKT_.encodeMultiPolygonGeometry_ = function(geom) {\n  var array = [];\n  var components = geom.getPolygons();\n  for (var i = 0, ii = components.length; i < ii; ++i) {\n    array.push('(' + _ol_format_WKT_.encodePolygonGeometry_(\n        components[i]) + ')');\n  }\n  return array.join(',');\n};\n\n/**\n * @param {ol.geom.SimpleGeometry} geom SimpleGeometry geometry.\n * @return {string} Potential dimensional information for WKT type.\n * @private\n */\n_ol_format_WKT_.encodeGeometryLayout_ = function(geom) {\n  var layout = geom.getLayout();\n  var dimInfo = '';\n  if (layout === _ol_geom_GeometryLayout_.XYZ || layout === _ol_geom_GeometryLayout_.XYZM) {\n    dimInfo += _ol_format_WKT_.Z;\n  }\n  if (layout === _ol_geom_GeometryLayout_.XYM || layout === _ol_geom_GeometryLayout_.XYZM) {\n    dimInfo += _ol_format_WKT_.M;\n  }\n  return dimInfo;\n};\n\n\n/**\n * Encode a geometry as WKT.\n * @param {ol.geom.Geometry} geom The geometry to encode.\n * @return {string} WKT string for the geometry.\n * @private\n */\n_ol_format_WKT_.encode_ = function(geom) {\n  var type = geom.getType();\n  var geometryEncoder = _ol_format_WKT_.GeometryEncoder_[type];\n  var enc = geometryEncoder(geom);\n  type = type.toUpperCase();\n  if (geom instanceof _ol_geom_SimpleGeometry_) {\n    var dimInfo = _ol_format_WKT_.encodeGeometryLayout_(geom);\n    if (dimInfo.length > 0) {\n      type += ' ' + dimInfo;\n    }\n  }\n  if (enc.length === 0) {\n    return type + ' ' + _ol_format_WKT_.EMPTY;\n  }\n  return type + '(' + enc + ')';\n};\n\n\n/**\n * @const\n * @type {Object.<string, function(ol.geom.Geometry): string>}\n * @private\n */\n_ol_format_WKT_.GeometryEncoder_ = {\n  'Point': _ol_format_WKT_.encodePointGeometry_,\n  'LineString': _ol_format_WKT_.encodeLineStringGeometry_,\n  'Polygon': _ol_format_WKT_.encodePolygonGeometry_,\n  'MultiPoint': _ol_format_WKT_.encodeMultiPointGeometry_,\n  'MultiLineString': _ol_format_WKT_.encodeMultiLineStringGeometry_,\n  'MultiPolygon': _ol_format_WKT_.encodeMultiPolygonGeometry_,\n  'GeometryCollection': _ol_format_WKT_.encodeGeometryCollectionGeometry_\n};\n\n\n/**\n * Parse a WKT string.\n * @param {string} wkt WKT string.\n * @return {ol.geom.Geometry|undefined}\n *     The geometry created.\n * @private\n */\n_ol_format_WKT_.prototype.parse_ = function(wkt) {\n  var lexer = new _ol_format_WKT_.Lexer(wkt);\n  var parser = new _ol_format_WKT_.Parser(lexer);\n  return parser.parse();\n};\n\n\n/**\n * Read a feature from a WKT source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {olx.format.ReadOptions=} opt_options Read options.\n * @return {ol.Feature} Feature.\n * @api\n */\n_ol_format_WKT_.prototype.readFeature;\n\n\n/**\n * @inheritDoc\n */\n_ol_format_WKT_.prototype.readFeatureFromText = function(text, opt_options) {\n  var geom = this.readGeometryFromText(text, opt_options);\n  if (geom) {\n    var feature = new _ol_Feature_();\n    feature.setGeometry(geom);\n    return feature;\n  }\n  return null;\n};\n\n\n/**\n * Read all features from a WKT source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {olx.format.ReadOptions=} opt_options Read options.\n * @return {Array.<ol.Feature>} Features.\n * @api\n */\n_ol_format_WKT_.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\n_ol_format_WKT_.prototype.readFeaturesFromText = function(text, opt_options) {\n  var geometries = [];\n  var geometry = this.readGeometryFromText(text, opt_options);\n  if (this.splitCollection_ &&\n      geometry.getType() == _ol_geom_GeometryType_.GEOMETRY_COLLECTION) {\n    geometries = (/** @type {ol.geom.GeometryCollection} */ (geometry))\n        .getGeometriesArray();\n  } else {\n    geometries = [geometry];\n  }\n  var feature, features = [];\n  for (var i = 0, ii = geometries.length; i < ii; ++i) {\n    feature = new _ol_Feature_();\n    feature.setGeometry(geometries[i]);\n    features.push(feature);\n  }\n  return features;\n};\n\n\n/**\n * Read a single geometry from a WKT source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {olx.format.ReadOptions=} opt_options Read options.\n * @return {ol.geom.Geometry} Geometry.\n * @api\n */\n_ol_format_WKT_.prototype.readGeometry;\n\n\n/**\n * @inheritDoc\n */\n_ol_format_WKT_.prototype.readGeometryFromText = function(text, opt_options) {\n  var geometry = this.parse_(text);\n  if (geometry) {\n    return (\n      /** @type {ol.geom.Geometry} */ _ol_format_Feature_.transformWithOptions(geometry, false, opt_options)\n    );\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * Encode a feature as a WKT string.\n *\n * @function\n * @param {ol.Feature} feature Feature.\n * @param {olx.format.WriteOptions=} opt_options Write options.\n * @return {string} WKT string.\n * @api\n */\n_ol_format_WKT_.prototype.writeFeature;\n\n\n/**\n * @inheritDoc\n */\n_ol_format_WKT_.prototype.writeFeatureText = function(feature, opt_options) {\n  var geometry = feature.getGeometry();\n  if (geometry) {\n    return this.writeGeometryText(geometry, opt_options);\n  }\n  return '';\n};\n\n\n/**\n * Encode an array of features as a WKT string.\n *\n * @function\n * @param {Array.<ol.Feature>} features Features.\n * @param {olx.format.WriteOptions=} opt_options Write options.\n * @return {string} WKT string.\n * @api\n */\n_ol_format_WKT_.prototype.writeFeatures;\n\n\n/**\n * @inheritDoc\n */\n_ol_format_WKT_.prototype.writeFeaturesText = function(features, opt_options) {\n  if (features.length == 1) {\n    return this.writeFeatureText(features[0], opt_options);\n  }\n  var geometries = [];\n  for (var i = 0, ii = features.length; i < ii; ++i) {\n    geometries.push(features[i].getGeometry());\n  }\n  var collection = new _ol_geom_GeometryCollection_(geometries);\n  return this.writeGeometryText(collection, opt_options);\n};\n\n\n/**\n * Write a single geometry as a WKT string.\n *\n * @function\n * @param {ol.geom.Geometry} geometry Geometry.\n * @param {olx.format.WriteOptions=} opt_options Write options.\n * @return {string} WKT string.\n * @api\n */\n_ol_format_WKT_.prototype.writeGeometry;\n\n\n/**\n * @inheritDoc\n */\n_ol_format_WKT_.prototype.writeGeometryText = function(geometry, opt_options) {\n  return _ol_format_WKT_.encode_(/** @type {ol.geom.Geometry} */ (\n    _ol_format_Feature_.transformWithOptions(geometry, true, opt_options)));\n};\n\n\n/**\n * @const\n * @enum {number}\n * @private\n */\n_ol_format_WKT_.TokenType_ = {\n  TEXT: 1,\n  LEFT_PAREN: 2,\n  RIGHT_PAREN: 3,\n  NUMBER: 4,\n  COMMA: 5,\n  EOF: 6\n};\n\n\n/**\n * Class to tokenize a WKT string.\n * @param {string} wkt WKT string.\n * @constructor\n * @protected\n */\n_ol_format_WKT_.Lexer = function(wkt) {\n\n  /**\n   * @type {string}\n   */\n  this.wkt = wkt;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.index_ = -1;\n};\n\n\n/**\n * @param {string} c Character.\n * @return {boolean} Whether the character is alphabetic.\n * @private\n */\n_ol_format_WKT_.Lexer.prototype.isAlpha_ = function(c) {\n  return c >= 'a' && c <= 'z' || c >= 'A' && c <= 'Z';\n};\n\n\n/**\n * @param {string} c Character.\n * @param {boolean=} opt_decimal Whether the string number\n *     contains a dot, i.e. is a decimal number.\n * @return {boolean} Whether the character is numeric.\n * @private\n */\n_ol_format_WKT_.Lexer.prototype.isNumeric_ = function(c, opt_decimal) {\n  var decimal = opt_decimal !== undefined ? opt_decimal : false;\n  return c >= '0' && c <= '9' || c == '.' && !decimal;\n};\n\n\n/**\n * @param {string} c Character.\n * @return {boolean} Whether the character is whitespace.\n * @private\n */\n_ol_format_WKT_.Lexer.prototype.isWhiteSpace_ = function(c) {\n  return c == ' ' || c == '\\t' || c == '\\r' || c == '\\n';\n};\n\n\n/**\n * @return {string} Next string character.\n * @private\n */\n_ol_format_WKT_.Lexer.prototype.nextChar_ = function() {\n  return this.wkt.charAt(++this.index_);\n};\n\n\n/**\n * Fetch and return the next token.\n * @return {!ol.WKTToken} Next string token.\n */\n_ol_format_WKT_.Lexer.prototype.nextToken = function() {\n  var c = this.nextChar_();\n  var token = {position: this.index_, value: c};\n\n  if (c == '(') {\n    token.type = _ol_format_WKT_.TokenType_.LEFT_PAREN;\n  } else if (c == ',') {\n    token.type = _ol_format_WKT_.TokenType_.COMMA;\n  } else if (c == ')') {\n    token.type = _ol_format_WKT_.TokenType_.RIGHT_PAREN;\n  } else if (this.isNumeric_(c) || c == '-') {\n    token.type = _ol_format_WKT_.TokenType_.NUMBER;\n    token.value = this.readNumber_();\n  } else if (this.isAlpha_(c)) {\n    token.type = _ol_format_WKT_.TokenType_.TEXT;\n    token.value = this.readText_();\n  } else if (this.isWhiteSpace_(c)) {\n    return this.nextToken();\n  } else if (c === '') {\n    token.type = _ol_format_WKT_.TokenType_.EOF;\n  } else {\n    throw new Error('Unexpected character: ' + c);\n  }\n\n  return token;\n};\n\n\n/**\n * @return {number} Numeric token value.\n * @private\n */\n_ol_format_WKT_.Lexer.prototype.readNumber_ = function() {\n  var c, index = this.index_;\n  var decimal = false;\n  var scientificNotation = false;\n  do {\n    if (c == '.') {\n      decimal = true;\n    } else if (c == 'e' || c == 'E') {\n      scientificNotation = true;\n    }\n    c = this.nextChar_();\n  } while (\n    this.isNumeric_(c, decimal) ||\n      // if we haven't detected a scientific number before, 'e' or 'E'\n      // hint that we should continue to read\n      !scientificNotation && (c == 'e' || c == 'E') ||\n      // once we know that we have a scientific number, both '-' and '+'\n      // are allowed\n      scientificNotation && (c == '-' || c == '+')\n  );\n  return parseFloat(this.wkt.substring(index, this.index_--));\n};\n\n\n/**\n * @return {string} String token value.\n * @private\n */\n_ol_format_WKT_.Lexer.prototype.readText_ = function() {\n  var c, index = this.index_;\n  do {\n    c = this.nextChar_();\n  } while (this.isAlpha_(c));\n  return this.wkt.substring(index, this.index_--).toUpperCase();\n};\n\n\n/**\n * Class to parse the tokens from the WKT string.\n * @param {ol.format.WKT.Lexer} lexer The lexer.\n * @constructor\n * @protected\n */\n_ol_format_WKT_.Parser = function(lexer) {\n\n  /**\n   * @type {ol.format.WKT.Lexer}\n   * @private\n   */\n  this.lexer_ = lexer;\n\n  /**\n   * @type {ol.WKTToken}\n   * @private\n   */\n  this.token_;\n\n  /**\n   * @type {ol.geom.GeometryLayout}\n   * @private\n   */\n  this.layout_ = _ol_geom_GeometryLayout_.XY;\n};\n\n\n/**\n * Fetch the next token form the lexer and replace the active token.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.consume_ = function() {\n  this.token_ = this.lexer_.nextToken();\n};\n\n/**\n * Tests if the given type matches the type of the current token.\n * @param {ol.format.WKT.TokenType_} type Token type.\n * @return {boolean} Whether the token matches the given type.\n */\n_ol_format_WKT_.Parser.prototype.isTokenType = function(type) {\n  var isMatch = this.token_.type == type;\n  return isMatch;\n};\n\n\n/**\n * If the given type matches the current token, consume it.\n * @param {ol.format.WKT.TokenType_} type Token type.\n * @return {boolean} Whether the token matches the given type.\n */\n_ol_format_WKT_.Parser.prototype.match = function(type) {\n  var isMatch = this.isTokenType(type);\n  if (isMatch) {\n    this.consume_();\n  }\n  return isMatch;\n};\n\n\n/**\n * Try to parse the tokens provided by the lexer.\n * @return {ol.geom.Geometry} The geometry.\n */\n_ol_format_WKT_.Parser.prototype.parse = function() {\n  this.consume_();\n  var geometry = this.parseGeometry_();\n  return geometry;\n};\n\n\n/**\n * Try to parse the dimensional info.\n * @return {ol.geom.GeometryLayout} The layout.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parseGeometryLayout_ = function() {\n  var layout = _ol_geom_GeometryLayout_.XY;\n  var dimToken = this.token_;\n  if (this.isTokenType(_ol_format_WKT_.TokenType_.TEXT)) {\n    var dimInfo = dimToken.value;\n    if (dimInfo === _ol_format_WKT_.Z) {\n      layout = _ol_geom_GeometryLayout_.XYZ;\n    } else if (dimInfo === _ol_format_WKT_.M) {\n      layout = _ol_geom_GeometryLayout_.XYM;\n    } else if (dimInfo === _ol_format_WKT_.ZM) {\n      layout = _ol_geom_GeometryLayout_.XYZM;\n    }\n    if (layout !== _ol_geom_GeometryLayout_.XY) {\n      this.consume_();\n    }\n  }\n  return layout;\n};\n\n\n/**\n * @return {!ol.geom.Geometry} The geometry.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parseGeometry_ = function() {\n  var token = this.token_;\n  if (this.match(_ol_format_WKT_.TokenType_.TEXT)) {\n    var geomType = token.value;\n    this.layout_ = this.parseGeometryLayout_();\n    if (geomType == _ol_geom_GeometryType_.GEOMETRY_COLLECTION.toUpperCase()) {\n      var geometries = this.parseGeometryCollectionText_();\n      return new _ol_geom_GeometryCollection_(geometries);\n    } else {\n      var parser = _ol_format_WKT_.Parser.GeometryParser_[geomType];\n      var ctor = _ol_format_WKT_.Parser.GeometryConstructor_[geomType];\n      if (!parser || !ctor) {\n        throw new Error('Invalid geometry type: ' + geomType);\n      }\n      var coordinates = parser.call(this);\n      return new ctor(coordinates, this.layout_);\n    }\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<ol.geom.Geometry>} A collection of geometries.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parseGeometryCollectionText_ = function() {\n  if (this.match(_ol_format_WKT_.TokenType_.LEFT_PAREN)) {\n    var geometries = [];\n    do {\n      geometries.push(this.parseGeometry_());\n    } while (this.match(_ol_format_WKT_.TokenType_.COMMA));\n    if (this.match(_ol_format_WKT_.TokenType_.RIGHT_PAREN)) {\n      return geometries;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return [];\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {Array.<number>} All values in a point.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parsePointText_ = function() {\n  if (this.match(_ol_format_WKT_.TokenType_.LEFT_PAREN)) {\n    var coordinates = this.parsePoint_();\n    if (this.match(_ol_format_WKT_.TokenType_.RIGHT_PAREN)) {\n      return coordinates;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return null;\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} All points in a linestring.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parseLineStringText_ = function() {\n  if (this.match(_ol_format_WKT_.TokenType_.LEFT_PAREN)) {\n    var coordinates = this.parsePointList_();\n    if (this.match(_ol_format_WKT_.TokenType_.RIGHT_PAREN)) {\n      return coordinates;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return [];\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} All points in a polygon.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parsePolygonText_ = function() {\n  if (this.match(_ol_format_WKT_.TokenType_.LEFT_PAREN)) {\n    var coordinates = this.parseLineStringTextList_();\n    if (this.match(_ol_format_WKT_.TokenType_.RIGHT_PAREN)) {\n      return coordinates;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return [];\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} All points in a multipoint.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parseMultiPointText_ = function() {\n  if (this.match(_ol_format_WKT_.TokenType_.LEFT_PAREN)) {\n    var coordinates;\n    if (this.token_.type == _ol_format_WKT_.TokenType_.LEFT_PAREN) {\n      coordinates = this.parsePointTextList_();\n    } else {\n      coordinates = this.parsePointList_();\n    }\n    if (this.match(_ol_format_WKT_.TokenType_.RIGHT_PAREN)) {\n      return coordinates;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return [];\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} All linestring points\n *                                        in a multilinestring.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parseMultiLineStringText_ = function() {\n  if (this.match(_ol_format_WKT_.TokenType_.LEFT_PAREN)) {\n    var coordinates = this.parseLineStringTextList_();\n    if (this.match(_ol_format_WKT_.TokenType_.RIGHT_PAREN)) {\n      return coordinates;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return [];\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} All polygon points in a multipolygon.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parseMultiPolygonText_ = function() {\n  if (this.match(_ol_format_WKT_.TokenType_.LEFT_PAREN)) {\n    var coordinates = this.parsePolygonTextList_();\n    if (this.match(_ol_format_WKT_.TokenType_.RIGHT_PAREN)) {\n      return coordinates;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return [];\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<number>} A point.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parsePoint_ = function() {\n  var coordinates = [];\n  var dimensions = this.layout_.length;\n  for (var i = 0; i < dimensions; ++i) {\n    var token = this.token_;\n    if (this.match(_ol_format_WKT_.TokenType_.NUMBER)) {\n      coordinates.push(token.value);\n    } else {\n      break;\n    }\n  }\n  if (coordinates.length == dimensions) {\n    return coordinates;\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} An array of points.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parsePointList_ = function() {\n  var coordinates = [this.parsePoint_()];\n  while (this.match(_ol_format_WKT_.TokenType_.COMMA)) {\n    coordinates.push(this.parsePoint_());\n  }\n  return coordinates;\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} An array of points.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parsePointTextList_ = function() {\n  var coordinates = [this.parsePointText_()];\n  while (this.match(_ol_format_WKT_.TokenType_.COMMA)) {\n    coordinates.push(this.parsePointText_());\n  }\n  return coordinates;\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} An array of points.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parseLineStringTextList_ = function() {\n  var coordinates = [this.parseLineStringText_()];\n  while (this.match(_ol_format_WKT_.TokenType_.COMMA)) {\n    coordinates.push(this.parseLineStringText_());\n  }\n  return coordinates;\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} An array of points.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.parsePolygonTextList_ = function() {\n  var coordinates = [this.parsePolygonText_()];\n  while (this.match(_ol_format_WKT_.TokenType_.COMMA)) {\n    coordinates.push(this.parsePolygonText_());\n  }\n  return coordinates;\n};\n\n\n/**\n * @return {boolean} Whether the token implies an empty geometry.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.isEmptyGeometry_ = function() {\n  var isEmpty = this.isTokenType(_ol_format_WKT_.TokenType_.TEXT) &&\n      this.token_.value == _ol_format_WKT_.EMPTY;\n  if (isEmpty) {\n    this.consume_();\n  }\n  return isEmpty;\n};\n\n\n/**\n * Create an error message for an unexpected token error.\n * @return {string} Error message.\n * @private\n */\n_ol_format_WKT_.Parser.prototype.formatErrorMessage_ = function() {\n  return 'Unexpected `' + this.token_.value + '` at position ' +\n      this.token_.position + ' in `' + this.lexer_.wkt + '`';\n};\n\n\n/**\n * @enum {function (new:ol.geom.Geometry, Array, ol.geom.GeometryLayout)}\n * @private\n */\n_ol_format_WKT_.Parser.GeometryConstructor_ = {\n  'POINT': _ol_geom_Point_,\n  'LINESTRING': _ol_geom_LineString_,\n  'POLYGON': _ol_geom_Polygon_,\n  'MULTIPOINT': _ol_geom_MultiPoint_,\n  'MULTILINESTRING': _ol_geom_MultiLineString_,\n  'MULTIPOLYGON': _ol_geom_MultiPolygon_\n};\n\n\n/**\n * @enum {(function(): Array)}\n * @private\n */\n_ol_format_WKT_.Parser.GeometryParser_ = {\n  'POINT': _ol_format_WKT_.Parser.prototype.parsePointText_,\n  'LINESTRING': _ol_format_WKT_.Parser.prototype.parseLineStringText_,\n  'POLYGON': _ol_format_WKT_.Parser.prototype.parsePolygonText_,\n  'MULTIPOINT': _ol_format_WKT_.Parser.prototype.parseMultiPointText_,\n  'MULTILINESTRING': _ol_format_WKT_.Parser.prototype.parseMultiLineStringText_,\n  'MULTIPOLYGON': _ol_format_WKT_.Parser.prototype.parseMultiPolygonText_\n};\nexport default _ol_format_WKT_;\n","import _ol_style_Fill_ from '../style/fill.js';\nimport _ol_style_TextPlacement_ from '../style/textplacement.js';\n\n/**\n * @classdesc\n * Set text style for vector features.\n *\n * @constructor\n * @param {olx.style.TextOptions=} opt_options Options.\n * @api\n */\nvar _ol_style_Text_ = function(opt_options) {\n\n  var options = opt_options || {};\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.font_ = options.font;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.rotation_ = options.rotation;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.rotateWithView_ = options.rotateWithView;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.scale_ = options.scale;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.text_ = options.text;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.textAlign_ = options.textAlign;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.textBaseline_ = options.textBaseline;\n\n  /**\n   * @private\n   * @type {ol.style.Fill}\n   */\n  this.fill_ = options.fill !== undefined ? options.fill :\n    new _ol_style_Fill_({color: _ol_style_Text_.DEFAULT_FILL_COLOR_});\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxAngle_ = options.maxAngle !== undefined ? options.maxAngle : Math.PI / 4;\n\n  /**\n   * @private\n   * @type {ol.style.TextPlacement|string}\n   */\n  this.placement_ = options.placement !== undefined ? options.placement : _ol_style_TextPlacement_.POINT;\n\n  //TODO Use options.overflow directly after removing @deprecated exceedLength\n  var overflow = options.overflow === undefined ? options.exceedLength : options.overflow;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.overflow_ = overflow !== undefined ? overflow : false;\n\n  /**\n   * @private\n   * @type {ol.style.Stroke}\n   */\n  this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.offsetX_ = options.offsetX !== undefined ? options.offsetX : 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.offsetY_ = options.offsetY !== undefined ? options.offsetY : 0;\n\n  /**\n   * @private\n   * @type {ol.style.Fill}\n   */\n  this.backgroundFill_ = options.backgroundFill ? options.backgroundFill : null;\n\n  /**\n   * @private\n   * @type {ol.style.Stroke}\n   */\n  this.backgroundStroke_ = options.backgroundStroke ? options.backgroundStroke : null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.padding_ = options.padding === undefined ? null : options.padding;\n};\n\n\n/**\n * The default fill color to use if no fill was set at construction time; a\n * blackish `#333`.\n *\n * @const {string}\n * @private\n */\n_ol_style_Text_.DEFAULT_FILL_COLOR_ = '#333';\n\n\n/**\n * Clones the style.\n * @return {ol.style.Text} The cloned style.\n * @api\n */\n_ol_style_Text_.prototype.clone = function() {\n  return new _ol_style_Text_({\n    font: this.getFont(),\n    placement: this.getPlacement(),\n    maxAngle: this.getMaxAngle(),\n    overflow: this.getOverflow(),\n    rotation: this.getRotation(),\n    rotateWithView: this.getRotateWithView(),\n    scale: this.getScale(),\n    text: this.getText(),\n    textAlign: this.getTextAlign(),\n    textBaseline: this.getTextBaseline(),\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n    offsetX: this.getOffsetX(),\n    offsetY: this.getOffsetY()\n  });\n};\n\n\n/**\n * Get the `overflow` configuration.\n * @return {boolean} Let text overflow the length of the path they follow.\n * @api\n */\n_ol_style_Text_.prototype.getOverflow = function() {\n  return this.overflow_;\n};\n\n\n/**\n * Get the font name.\n * @return {string|undefined} Font.\n * @api\n */\n_ol_style_Text_.prototype.getFont = function() {\n  return this.font_;\n};\n\n\n/**\n * Get the maximum angle between adjacent characters.\n * @return {number} Angle in radians.\n * @api\n */\n_ol_style_Text_.prototype.getMaxAngle = function() {\n  return this.maxAngle_;\n};\n\n\n/**\n * Get the label placement.\n * @return {ol.style.TextPlacement|string} Text placement.\n * @api\n */\n_ol_style_Text_.prototype.getPlacement = function() {\n  return this.placement_;\n};\n\n\n/**\n * Get the x-offset for the text.\n * @return {number} Horizontal text offset.\n * @api\n */\n_ol_style_Text_.prototype.getOffsetX = function() {\n  return this.offsetX_;\n};\n\n\n/**\n * Get the y-offset for the text.\n * @return {number} Vertical text offset.\n * @api\n */\n_ol_style_Text_.prototype.getOffsetY = function() {\n  return this.offsetY_;\n};\n\n\n/**\n * Get the fill style for the text.\n * @return {ol.style.Fill} Fill style.\n * @api\n */\n_ol_style_Text_.prototype.getFill = function() {\n  return this.fill_;\n};\n\n\n/**\n * Determine whether the text rotates with the map.\n * @return {boolean|undefined} Rotate with map.\n * @api\n */\n_ol_style_Text_.prototype.getRotateWithView = function() {\n  return this.rotateWithView_;\n};\n\n\n/**\n * Get the text rotation.\n * @return {number|undefined} Rotation.\n * @api\n */\n_ol_style_Text_.prototype.getRotation = function() {\n  return this.rotation_;\n};\n\n\n/**\n * Get the text scale.\n * @return {number|undefined} Scale.\n * @api\n */\n_ol_style_Text_.prototype.getScale = function() {\n  return this.scale_;\n};\n\n\n/**\n * Get the stroke style for the text.\n * @return {ol.style.Stroke} Stroke style.\n * @api\n */\n_ol_style_Text_.prototype.getStroke = function() {\n  return this.stroke_;\n};\n\n\n/**\n * Get the text to be rendered.\n * @return {string|undefined} Text.\n * @api\n */\n_ol_style_Text_.prototype.getText = function() {\n  return this.text_;\n};\n\n\n/**\n * Get the text alignment.\n * @return {string|undefined} Text align.\n * @api\n */\n_ol_style_Text_.prototype.getTextAlign = function() {\n  return this.textAlign_;\n};\n\n\n/**\n * Get the text baseline.\n * @return {string|undefined} Text baseline.\n * @api\n */\n_ol_style_Text_.prototype.getTextBaseline = function() {\n  return this.textBaseline_;\n};\n\n\n/**\n * Get the background fill style for the text.\n * @return {ol.style.Fill} Fill style.\n * @api\n */\n_ol_style_Text_.prototype.getBackgroundFill = function() {\n  return this.backgroundFill_;\n};\n\n\n/**\n * Get the background stroke style for the text.\n * @return {ol.style.Stroke} Stroke style.\n * @api\n */\n_ol_style_Text_.prototype.getBackgroundStroke = function() {\n  return this.backgroundStroke_;\n};\n\n\n/**\n * Get the padding for the text.\n * @return {Array.<number>} Padding.\n * @api\n */\n_ol_style_Text_.prototype.getPadding = function() {\n  return this.padding_;\n};\n\n\n/**\n * Set the `overflow` property.\n *\n * @param {boolean} overflow Let text overflow the path that it follows.\n * @api\n */\n_ol_style_Text_.prototype.setOverflow = function(overflow) {\n  this.overflow_ = overflow;\n};\n\n\n/**\n * Set the font.\n *\n * @param {string|undefined} font Font.\n * @api\n */\n_ol_style_Text_.prototype.setFont = function(font) {\n  this.font_ = font;\n};\n\n\n/**\n * Set the maximum angle between adjacent characters.\n *\n * @param {number} maxAngle Angle in radians.\n * @api\n */\n_ol_style_Text_.prototype.setMaxAngle = function(maxAngle) {\n  this.maxAngle_ = maxAngle;\n};\n\n\n/**\n * Set the x offset.\n *\n * @param {number} offsetX Horizontal text offset.\n * @api\n */\n_ol_style_Text_.prototype.setOffsetX = function(offsetX) {\n  this.offsetX_ = offsetX;\n};\n\n\n/**\n * Set the y offset.\n *\n * @param {number} offsetY Vertical text offset.\n * @api\n */\n_ol_style_Text_.prototype.setOffsetY = function(offsetY) {\n  this.offsetY_ = offsetY;\n};\n\n\n/**\n * Set the text placement.\n *\n * @param {ol.style.TextPlacement|string} placement Placement.\n * @api\n */\n_ol_style_Text_.prototype.setPlacement = function(placement) {\n  this.placement_ = placement;\n};\n\n\n/**\n * Set the fill.\n *\n * @param {ol.style.Fill} fill Fill style.\n * @api\n */\n_ol_style_Text_.prototype.setFill = function(fill) {\n  this.fill_ = fill;\n};\n\n\n/**\n * Set the rotation.\n *\n * @param {number|undefined} rotation Rotation.\n * @api\n */\n_ol_style_Text_.prototype.setRotation = function(rotation) {\n  this.rotation_ = rotation;\n};\n\n\n/**\n * Set the scale.\n *\n * @param {number|undefined} scale Scale.\n * @api\n */\n_ol_style_Text_.prototype.setScale = function(scale) {\n  this.scale_ = scale;\n};\n\n\n/**\n * Set the stroke.\n *\n * @param {ol.style.Stroke} stroke Stroke style.\n * @api\n */\n_ol_style_Text_.prototype.setStroke = function(stroke) {\n  this.stroke_ = stroke;\n};\n\n\n/**\n * Set the text.\n *\n * @param {string|undefined} text Text.\n * @api\n */\n_ol_style_Text_.prototype.setText = function(text) {\n  this.text_ = text;\n};\n\n\n/**\n * Set the text alignment.\n *\n * @param {string|undefined} textAlign Text align.\n * @api\n */\n_ol_style_Text_.prototype.setTextAlign = function(textAlign) {\n  this.textAlign_ = textAlign;\n};\n\n\n/**\n * Set the text baseline.\n *\n * @param {string|undefined} textBaseline Text baseline.\n * @api\n */\n_ol_style_Text_.prototype.setTextBaseline = function(textBaseline) {\n  this.textBaseline_ = textBaseline;\n};\n\n\n/**\n * Set the background fill.\n *\n * @param {ol.style.Fill} fill Fill style.\n * @api\n */\n_ol_style_Text_.prototype.setBackgroundFill = function(fill) {\n  this.backgroundFill_ = fill;\n};\n\n\n/**\n * Set the background stroke.\n *\n * @param {ol.style.Stroke} stroke Stroke style.\n * @api\n */\n_ol_style_Text_.prototype.setBackgroundStroke = function(stroke) {\n  this.backgroundStroke_ = stroke;\n};\n\n\n/**\n * Set the padding (`[top, right, bottom, left]`).\n *\n * @param {!Array.<number>} padding Padding.\n * @api\n */\n_ol_style_Text_.prototype.setPadding = function(padding) {\n  this.padding_ = padding;\n};\nexport default _ol_style_Text_;\n","import _ol_ from '../index.js';\nimport _ol_source_XYZ_ from '../source/xyz.js';\n\n/**\n * @classdesc\n * Layer source for the OpenStreetMap tile server.\n *\n * @constructor\n * @extends {ol.source.XYZ}\n * @param {olx.source.OSMOptions=} opt_options Open Street Map options.\n * @api\n */\nvar _ol_source_OSM_ = function(opt_options) {\n\n  var options = opt_options || {};\n\n  var attributions;\n  if (options.attributions !== undefined) {\n    attributions = options.attributions;\n  } else {\n    attributions = [_ol_source_OSM_.ATTRIBUTION];\n  }\n\n  var crossOrigin = options.crossOrigin !== undefined ?\n    options.crossOrigin : 'anonymous';\n\n  var url = options.url !== undefined ?\n    options.url : 'https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png';\n\n  _ol_source_XYZ_.call(this, {\n    attributions: attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: crossOrigin,\n    opaque: options.opaque !== undefined ? options.opaque : true,\n    maxZoom: options.maxZoom !== undefined ? options.maxZoom : 19,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileLoadFunction: options.tileLoadFunction,\n    url: url,\n    wrapX: options.wrapX\n  });\n\n};\n\n_ol_.inherits(_ol_source_OSM_, _ol_source_XYZ_);\n\n\n/**\n * The attribution containing a link to the OpenStreetMap Copyright and License\n * page.\n * @const\n * @type {string}\n * @api\n */\n_ol_source_OSM_.ATTRIBUTION = '&copy; ' +\n      '<a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> ' +\n      'contributors.';\nexport default _ol_source_OSM_;\n","import _ol_ from '../index.js';\nimport _ol_array_ from '../array.js';\nimport _ol_proj_ from '../proj.js';\nimport _ol_tilegrid_TileGrid_ from '../tilegrid/tilegrid.js';\n\n/**\n * @classdesc\n * Set the grid pattern for sources accessing WMTS tiled-image servers.\n *\n * @constructor\n * @extends {ol.tilegrid.TileGrid}\n * @param {olx.tilegrid.WMTSOptions} options WMTS options.\n * @struct\n * @api\n */\nvar _ol_tilegrid_WMTS_ = function(options) {\n  /**\n   * @private\n   * @type {!Array.<string>}\n   */\n  this.matrixIds_ = options.matrixIds;\n  // FIXME: should the matrixIds become optional?\n\n  _ol_tilegrid_TileGrid_.call(this, {\n    extent: options.extent,\n    origin: options.origin,\n    origins: options.origins,\n    resolutions: options.resolutions,\n    tileSize: options.tileSize,\n    tileSizes: options.tileSizes,\n    sizes: options.sizes\n  });\n};\n\n_ol_.inherits(_ol_tilegrid_WMTS_, _ol_tilegrid_TileGrid_);\n\n\n/**\n * @param {number} z Z.\n * @return {string} MatrixId..\n */\n_ol_tilegrid_WMTS_.prototype.getMatrixId = function(z) {\n  return this.matrixIds_[z];\n};\n\n\n/**\n * Get the list of matrix identifiers.\n * @return {Array.<string>} MatrixIds.\n * @api\n */\n_ol_tilegrid_WMTS_.prototype.getMatrixIds = function() {\n  return this.matrixIds_;\n};\n\n\n/**\n * Create a tile grid from a WMTS capabilities matrix set and an\n * optional TileMatrixSetLimits.\n * @param {Object} matrixSet An object representing a matrixSet in the\n *     capabilities document.\n * @param {ol.Extent=} opt_extent An optional extent to restrict the tile\n *     ranges the server provides.\n * @param {Array.<Object>=} opt_matrixLimits An optional object representing\n *     the available matrices for tileGrid.\n * @return {ol.tilegrid.WMTS} WMTS tileGrid instance.\n * @api\n */\n_ol_tilegrid_WMTS_.createFromCapabilitiesMatrixSet = function(matrixSet, opt_extent,\n    opt_matrixLimits) {\n\n  /** @type {!Array.<number>} */\n  var resolutions = [];\n  /** @type {!Array.<string>} */\n  var matrixIds = [];\n  /** @type {!Array.<ol.Coordinate>} */\n  var origins = [];\n  /** @type {!Array.<ol.Size>} */\n  var tileSizes = [];\n  /** @type {!Array.<ol.Size>} */\n  var sizes = [];\n\n  var matrixLimits = opt_matrixLimits !== undefined ? opt_matrixLimits : [];\n\n  var supportedCRSPropName = 'SupportedCRS';\n  var matrixIdsPropName = 'TileMatrix';\n  var identifierPropName = 'Identifier';\n  var scaleDenominatorPropName = 'ScaleDenominator';\n  var topLeftCornerPropName = 'TopLeftCorner';\n  var tileWidthPropName = 'TileWidth';\n  var tileHeightPropName = 'TileHeight';\n\n  var code = matrixSet[supportedCRSPropName];\n  var projection = _ol_proj_.get(code.replace(/urn:ogc:def:crs:(\\w+):(.*:)?(\\w+)$/, '$1:$3')) ||\n      _ol_proj_.get(code);\n  var metersPerUnit = projection.getMetersPerUnit();\n  // swap origin x and y coordinates if axis orientation is lat/long\n  var switchOriginXY = projection.getAxisOrientation().substr(0, 2) == 'ne';\n\n  matrixSet[matrixIdsPropName].sort(function(a, b) {\n    return b[scaleDenominatorPropName] - a[scaleDenominatorPropName];\n  });\n\n  matrixSet[matrixIdsPropName].forEach(function(elt, index, array) {\n\n    var matrixAvailable;\n    // use of matrixLimits to filter TileMatrices from GetCapabilities\n    // TileMatrixSet from unavailable matrix levels.\n    if (matrixLimits.length > 0) {\n      matrixAvailable = _ol_array_.find(matrixLimits,\n          function(elt_ml, index_ml, array_ml) {\n            return elt[identifierPropName] == elt_ml[matrixIdsPropName];\n          });\n    } else {\n      matrixAvailable = true;\n    }\n\n    if (matrixAvailable) {\n      matrixIds.push(elt[identifierPropName]);\n      var resolution = elt[scaleDenominatorPropName] * 0.28E-3 / metersPerUnit;\n      var tileWidth = elt[tileWidthPropName];\n      var tileHeight = elt[tileHeightPropName];\n      if (switchOriginXY) {\n        origins.push([elt[topLeftCornerPropName][1],\n          elt[topLeftCornerPropName][0]]);\n      } else {\n        origins.push(elt[topLeftCornerPropName]);\n      }\n      resolutions.push(resolution);\n      tileSizes.push(tileWidth == tileHeight ?\n        tileWidth : [tileWidth, tileHeight]);\n      // top-left origin, so height is negative\n      sizes.push([elt['MatrixWidth'], -elt['MatrixHeight']]);\n    }\n  });\n\n  return new _ol_tilegrid_WMTS_({\n    extent: opt_extent,\n    origins: origins,\n    resolutions: resolutions,\n    matrixIds: matrixIds,\n    tileSizes: tileSizes,\n    sizes: sizes\n  });\n};\nexport default _ol_tilegrid_WMTS_;\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BuffAnalysis.vue?vue&type=style&index=0&id=1f3af891&prod&lang=css&\"","// FIXME add minZoom support\n// FIXME add date line wrap (tile coord transform)\n// FIXME cannot be shared between maps with different projections\n\nimport _ol_ from '../index.js';\nimport _ol_asserts_ from '../asserts.js';\nimport _ol_extent_ from '../extent.js';\nimport _ol_obj_ from '../obj.js';\nimport _ol_math_ from '../math.js';\nimport _ol_proj_ from '../proj.js';\nimport _ol_reproj_ from '../reproj.js';\nimport _ol_size_ from '../size.js';\nimport _ol_source_TileImage_ from '../source/tileimage.js';\nimport _ol_source_WMSServerType_ from '../source/wmsservertype.js';\nimport _ol_tilecoord_ from '../tilecoord.js';\nimport _ol_string_ from '../string.js';\nimport _ol_uri_ from '../uri.js';\n\n/**\n * @classdesc\n * Layer source for tile data from WMS servers.\n *\n * @constructor\n * @extends {ol.source.TileImage}\n * @param {olx.source.TileWMSOptions=} opt_options Tile WMS options.\n * @api\n */\nvar _ol_source_TileWMS_ = function(opt_options) {\n\n  var options = opt_options || {};\n\n  var params = options.params || {};\n\n  var transparent = 'TRANSPARENT' in params ? params['TRANSPARENT'] : true;\n\n  _ol_source_TileImage_.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: options.crossOrigin,\n    logo: options.logo,\n    opaque: !transparent,\n    projection: options.projection,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileClass: options.tileClass,\n    tileGrid: options.tileGrid,\n    tileLoadFunction: options.tileLoadFunction,\n    url: options.url,\n    urls: options.urls,\n    wrapX: options.wrapX !== undefined ? options.wrapX : true,\n    transition: options.transition\n  });\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.gutter_ = options.gutter !== undefined ? options.gutter : 0;\n\n  /**\n   * @private\n   * @type {!Object}\n   */\n  this.params_ = params;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.v13_ = true;\n\n  /**\n   * @private\n   * @type {ol.source.WMSServerType|undefined}\n   */\n  this.serverType_ = /** @type {ol.source.WMSServerType|undefined} */ (options.serverType);\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.hidpi_ = options.hidpi !== undefined ? options.hidpi : true;\n\n  /**\n   * @private\n   * @type {ol.Extent}\n   */\n  this.tmpExtent_ = _ol_extent_.createEmpty();\n\n  this.updateV13_();\n  this.setKey(this.getKeyForParams_());\n\n};\n\n_ol_.inherits(_ol_source_TileWMS_, _ol_source_TileImage_);\n\n\n/**\n * Return the GetFeatureInfo URL for the passed coordinate, resolution, and\n * projection. Return `undefined` if the GetFeatureInfo URL cannot be\n * constructed.\n * @param {ol.Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {ol.ProjectionLike} projection Projection.\n * @param {!Object} params GetFeatureInfo params. `INFO_FORMAT` at least should\n *     be provided. If `QUERY_LAYERS` is not provided then the layers specified\n *     in the `LAYERS` parameter will be used. `VERSION` should not be\n *     specified here.\n * @return {string|undefined} GetFeatureInfo URL.\n * @api\n */\n_ol_source_TileWMS_.prototype.getGetFeatureInfoUrl = function(coordinate, resolution, projection, params) {\n  var projectionObj = _ol_proj_.get(projection);\n  var sourceProjectionObj = this.getProjection();\n\n  var tileGrid = this.getTileGrid();\n  if (!tileGrid) {\n    tileGrid = this.getTileGridForProjection(projectionObj);\n  }\n\n  var tileCoord = tileGrid.getTileCoordForCoordAndResolution(coordinate, resolution);\n\n  if (tileGrid.getResolutions().length <= tileCoord[0]) {\n    return undefined;\n  }\n\n  var tileResolution = tileGrid.getResolution(tileCoord[0]);\n  var tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent_);\n  var tileSize = _ol_size_.toSize(tileGrid.getTileSize(tileCoord[0]), this.tmpSize);\n\n\n  var gutter = this.gutter_;\n  if (gutter !== 0) {\n    tileSize = _ol_size_.buffer(tileSize, gutter, this.tmpSize);\n    tileExtent = _ol_extent_.buffer(tileExtent, tileResolution * gutter, tileExtent);\n  }\n\n  if (sourceProjectionObj && sourceProjectionObj !== projectionObj) {\n    tileResolution = _ol_reproj_.calculateSourceResolution(sourceProjectionObj, projectionObj, coordinate, tileResolution);\n    tileExtent = _ol_proj_.transformExtent(tileExtent, projectionObj, sourceProjectionObj);\n    coordinate = _ol_proj_.transform(coordinate, projectionObj, sourceProjectionObj);\n  }\n\n  var baseParams = {\n    'SERVICE': 'WMS',\n    'VERSION': _ol_.DEFAULT_WMS_VERSION,\n    'REQUEST': 'GetFeatureInfo',\n    'FORMAT': 'image/png',\n    'TRANSPARENT': true,\n    'QUERY_LAYERS': this.params_['LAYERS']\n  };\n  _ol_obj_.assign(baseParams, this.params_, params);\n\n  var x = Math.floor((coordinate[0] - tileExtent[0]) / tileResolution);\n  var y = Math.floor((tileExtent[3] - coordinate[1]) / tileResolution);\n\n  baseParams[this.v13_ ? 'I' : 'X'] = x;\n  baseParams[this.v13_ ? 'J' : 'Y'] = y;\n\n  return this.getRequestUrl_(tileCoord, tileSize, tileExtent,\n      1, sourceProjectionObj || projectionObj, baseParams);\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_source_TileWMS_.prototype.getGutterInternal = function() {\n  return this.gutter_;\n};\n\n\n/**\n * Get the user-provided params, i.e. those passed to the constructor through\n * the \"params\" option, and possibly updated using the updateParams method.\n * @return {Object} Params.\n * @api\n */\n_ol_source_TileWMS_.prototype.getParams = function() {\n  return this.params_;\n};\n\n\n/**\n * @param {ol.TileCoord} tileCoord Tile coordinate.\n * @param {ol.Size} tileSize Tile size.\n * @param {ol.Extent} tileExtent Tile extent.\n * @param {number} pixelRatio Pixel ratio.\n * @param {ol.proj.Projection} projection Projection.\n * @param {Object} params Params.\n * @return {string|undefined} Request URL.\n * @private\n */\n_ol_source_TileWMS_.prototype.getRequestUrl_ = function(tileCoord, tileSize, tileExtent,\n    pixelRatio, projection, params) {\n\n  var urls = this.urls;\n  if (!urls) {\n    return undefined;\n  }\n\n  params['WIDTH'] = tileSize[0];\n  params['HEIGHT'] = tileSize[1];\n\n  params[this.v13_ ? 'CRS' : 'SRS'] = projection.getCode();\n\n  if (!('STYLES' in this.params_)) {\n    params['STYLES'] = '';\n  }\n\n  if (pixelRatio != 1) {\n    switch (this.serverType_) {\n      case _ol_source_WMSServerType_.GEOSERVER:\n        var dpi = (90 * pixelRatio + 0.5) | 0;\n        if ('FORMAT_OPTIONS' in params) {\n          params['FORMAT_OPTIONS'] += ';dpi:' + dpi;\n        } else {\n          params['FORMAT_OPTIONS'] = 'dpi:' + dpi;\n        }\n        break;\n      case _ol_source_WMSServerType_.MAPSERVER:\n        params['MAP_RESOLUTION'] = 90 * pixelRatio;\n        break;\n      case _ol_source_WMSServerType_.CARMENTA_SERVER:\n      case _ol_source_WMSServerType_.QGIS:\n        params['DPI'] = 90 * pixelRatio;\n        break;\n      default:\n        _ol_asserts_.assert(false, 52); // Unknown `serverType` configured\n        break;\n    }\n  }\n\n  var axisOrientation = projection.getAxisOrientation();\n  var bbox = tileExtent;\n  if (this.v13_ && axisOrientation.substr(0, 2) == 'ne') {\n    var tmp;\n    tmp = tileExtent[0];\n    bbox[0] = tileExtent[1];\n    bbox[1] = tmp;\n    tmp = tileExtent[2];\n    bbox[2] = tileExtent[3];\n    bbox[3] = tmp;\n  }\n  params['BBOX'] = bbox.join(',');\n\n  var url;\n  if (urls.length == 1) {\n    url = urls[0];\n  } else {\n    var index = _ol_math_.modulo(_ol_tilecoord_.hash(tileCoord), urls.length);\n    url = urls[index];\n  }\n  return _ol_uri_.appendParams(url, params);\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_source_TileWMS_.prototype.getTilePixelRatio = function(pixelRatio) {\n  return (!this.hidpi_ || this.serverType_ === undefined) ? 1 :\n  /** @type {number} */ (pixelRatio);\n};\n\n\n/**\n * @private\n * @return {string} The key for the current params.\n */\n_ol_source_TileWMS_.prototype.getKeyForParams_ = function() {\n  var i = 0;\n  var res = [];\n  for (var key in this.params_) {\n    res[i++] = key + '-' + this.params_[key];\n  }\n  return res.join('/');\n};\n\n\n/**\n * @inheritDoc\n */\n_ol_source_TileWMS_.prototype.fixedTileUrlFunction = function(tileCoord, pixelRatio, projection) {\n\n  var tileGrid = this.getTileGrid();\n  if (!tileGrid) {\n    tileGrid = this.getTileGridForProjection(projection);\n  }\n\n  if (tileGrid.getResolutions().length <= tileCoord[0]) {\n    return undefined;\n  }\n\n  if (pixelRatio != 1 && (!this.hidpi_ || this.serverType_ === undefined)) {\n    pixelRatio = 1;\n  }\n\n  var tileResolution = tileGrid.getResolution(tileCoord[0]);\n  var tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent_);\n  var tileSize = _ol_size_.toSize(\n      tileGrid.getTileSize(tileCoord[0]), this.tmpSize);\n\n  var gutter = this.gutter_;\n  if (gutter !== 0) {\n    tileSize = _ol_size_.buffer(tileSize, gutter, this.tmpSize);\n    tileExtent = _ol_extent_.buffer(tileExtent,\n        tileResolution * gutter, tileExtent);\n  }\n\n  if (pixelRatio != 1) {\n    tileSize = _ol_size_.scale(tileSize, pixelRatio, this.tmpSize);\n  }\n\n  var baseParams = {\n    'SERVICE': 'WMS',\n    'VERSION': _ol_.DEFAULT_WMS_VERSION,\n    'REQUEST': 'GetMap',\n    'FORMAT': 'image/png',\n    'TRANSPARENT': true\n  };\n  _ol_obj_.assign(baseParams, this.params_);\n\n  return this.getRequestUrl_(tileCoord, tileSize, tileExtent,\n      pixelRatio, projection, baseParams);\n};\n\n/**\n * Update the user-provided params.\n * @param {Object} params Params.\n * @api\n */\n_ol_source_TileWMS_.prototype.updateParams = function(params) {\n  _ol_obj_.assign(this.params_, params);\n  this.updateV13_();\n  this.setKey(this.getKeyForParams_());\n};\n\n\n/**\n * @private\n */\n_ol_source_TileWMS_.prototype.updateV13_ = function() {\n  var version = this.params_['VERSION'] || _ol_.DEFAULT_WMS_VERSION;\n  this.v13_ = _ol_string_.compareVersions(version, '1.3') >= 0;\n};\nexport default _ol_source_TileWMS_;\n","var _ol_uri_ = {};\n\n\n/**\n * Appends query parameters to a URI.\n *\n * @param {string} uri The original URI, which may already have query data.\n * @param {!Object} params An object where keys are URI-encoded parameter keys,\n *     and the values are arbitrary types or arrays.\n * @return {string} The new URI.\n */\n_ol_uri_.appendParams = function(uri, params) {\n  var keyParams = [];\n  // Skip any null or undefined parameter values\n  Object.keys(params).forEach(function(k) {\n    if (params[k] !== null && params[k] !== undefined) {\n      keyParams.push(k + '=' + encodeURIComponent(params[k]));\n    }\n  });\n  var qs = keyParams.join('&');\n  // remove any trailing ? or &\n  uri = uri.replace(/[?&]$/, '');\n  // append ? or & depending on whether uri has existing parameters\n  uri = uri.indexOf('?') === -1 ? uri + '?' : uri + '&';\n  return uri + qs;\n};\nexport default _ol_uri_;\n"],"sourceRoot":""}